<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Chương 5. Các tệp khác trong thư mục debian</title>
    <link rel="stylesheet" type="text/css" href="debian.css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="home" href="index.vi.html" title="Debian New Maintainers' Guide"/>
    <link rel="up" href="index.vi.html" title="Debian New Maintainers' Guide"/>
    <link rel="prev" href="dreq.vi.html" title="Chương 4. Các tệp yêu cầu trong thư mục debian"/>
    <link rel="next" href="build.vi.html" title="Chương 6. Biên dịch gói"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Chương 5. Các tệp khác trong thư mục <code class="filename">debian</code></th>
        </tr>
        <tr>
          <td align="left"><a accesskey="p" href="dreq.vi.html"><img src="images/prev.png" alt="Trước đó"/></a> </td>
          <th width="60%" align="center"> </th>
          <td align="right"> <a accesskey="n" href="build.vi.html"><img src="images/next.png" alt="Kế tiếp"/></a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="chapter">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="dother"/>Chương 5. Các tệp khác trong thư mục <code class="filename">debian</code></h1>
          </div>
        </div>
      </div>
      <div class="toc">
        <p>
          <strong>Mục lục</strong>
        </p>
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="dother.vi.html#readme">5.1. <code class="filename">README.Debian</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#compat">5.2. <code class="filename">compat</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#conffiles">5.3. <code class="filename">conffiles</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#crond">5.4. <code class="filename"><em class="replaceable"><code>package</code></em>.cron.*</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#dirs">5.5. <code class="filename">dirs</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#doc-base">5.6. <code class="filename"><em class="replaceable"><code>package</code></em>.doc-base</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#docs">5.7. <code class="filename">docs</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#emacsen">5.8. <code class="filename">emacsen-*</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#examples">5.9. <code class="filename"><em class="replaceable"><code>package</code></em>.examples</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#initd">5.10. <code class="filename"><em class="replaceable"><code>package</code></em>.init</code> và
<code class="filename"><em class="replaceable"><code>package</code></em>.default</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#install">5.11. <code class="filename">install</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#info">5.12. <code class="filename"><em class="replaceable"><code>package</code></em>.info</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#links">5.13. <code class="filename"><em class="replaceable"><code>package</code></em>.links</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#lintian">5.14. <code class="filename">{<em class="replaceable"><code>package</code></em>.,source/}lintian-overrides</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#manpage">5.15. <code class="filename">manpage.*</code></a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="dother.vi.html#manpage1">5.15.1. <code class="filename">manpage.1.ex</code></a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dother.vi.html#manpagesgml">5.15.2. <code class="filename">manpage.sgml.ex</code></a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dother.vi.html#manpagexml">5.15.3. <code class="filename">manpage.xml.ex</code></a>
                </span>
              </dt>
            </dl>
          </dd>
          <dt>
            <span class="section">
              <a href="dother.vi.html#manpages">5.16. <code class="filename"><em class="replaceable"><code>package</code></em>.manpages</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#news">5.17. <code class="filename">NEWS</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#maintscripts">5.18. <code class="filename">{pre,post}{inst,rm}</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#symbols">5.19. <code class="filename"><em class="replaceable"><code>package</code></em>.symbols</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#todo">5.20. <code class="filename">TODO</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#watch">5.21. <code class="filename">watch</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#sourcef">5.22. <code class="filename">source/format</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#sourcel">5.23. <code class="filename">source/local-options</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#sourceopt">5.24. <code class="filename">source/options</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dother.vi.html#patches">5.25. <code class="filename">patches/*</code></a>
            </span>
          </dt>
        </dl>
      </div>
      <p>
Để kiểm soát hầu hết những gì <code class="systemitem">debhelper</code> thực hiện khi xây dựng gói, bạn thêm
các tệp cấu hình tuỳ chọn trong thư mục <code class="filename">debian</code>. Chương
này sẽ cung cấp một cái nhìn tổng quan về những tệp tin này và định dạng của
nó.  Vui lòng tham khảo thêm <a class="ulink" href="http://www.debian.org/doc/devel-manuals#policy">Debian Policy
Manual</a> và <a class="ulink" href="http://www.debian.org/doc/devel-manuals#devref">Debian Developer's
Reference</a>.
</p>
      <p>
Lệnh <span class="command"><strong>dh_make</strong></span> sẽ tạo một số tệp cấu hình mẫu dưới thư mục
<code class="filename">debian</code>.  Hầu hết tên các tập tin có hậu tố là
<code class="literal">.ex</code>.  Một số chúng có các tên tệp bắt đầu bằng tên gói
nhị phân như <code class="literal"><em class="replaceable"><code>package</code></em></code>. Hãy xem
tất cả tại. <a href="#ftn.idm2006" class="footnote" id="idm2006"><sup class="footnote">[54]</sup></a>
</p>
      <p>
Một số tệp cấu hình mẫu cho <code class="systemitem">debhelper</code> có thể không được tạo bởi lệnh
<span class="command"><strong>dh_make</strong></span>. Trong các trường hợp này, bạn cần phải tự tạo
chúng bằng trình soạn thảo.
</p>
      <p>
Nếu bạn muốn hoặc cần kích hoạt bất kỳ tệp nào, hãy làm như sau:
</p>
      <div class="itemizedlist">
        <ul class="itemizedlist">
          <li class="listitem">
            <p>
Đổi tên các tệp mẫu bằng cách xoá bỏ hậu tố <code class="literal">.ex</code> hoặc
<code class="literal">.EX</code> nếu có;
</p>
          </li>
          <li class="listitem">
            <p>
Đổi tên các tệp cấu hình để sử dụng tên gói thực sự của thay cho
<code class="literal"><em class="replaceable"><code>package</code></em></code>;
</p>
          </li>
          <li class="listitem">
            <p>
sửa đổi nội dung tệp mẫu theo ý bạn muốn;
</p>
          </li>
          <li class="listitem">
            <p>
loại bỏ các tập tin mẫu mà bạn không cần;
</p>
          </li>
          <li class="listitem">
            <p>
sửa đổi tệp <code class="filename">control</code> (xem <a class="xref" href="dreq.vi.html#control" title="4.1. control">Phần 4.1, “<code class="filename">control</code>”</a>),
nếu bạn cần;
</p>
          </li>
          <li class="listitem">
            <p>
chỉnh sửa tệp <code class="filename">rules</code> (xem <a class="xref" href="dreq.vi.html#rules" title="4.4. rules">Phần 4.4, “<code class="filename">rules</code>”</a>), nếu
bạn cần.
</p>
          </li>
        </ul>
      </div>
      <p>
Bất kỳ tệp tin cấu hình <code class="systemitem">debhelper</code>
nào mà không có tiền tố
<code class="filename"><em class="replaceable"><code>package</code></em></code>, chẳng hạn như
<code class="filename"> install </code>, sẽ áp dụng cho gói nhị phân đầu tiên. Khi có
nhiều gói nhị phân, các cấu hình của chúng được xác định bằng các tệp chứa
tiền tố là tên gói nhị phân đấy như
<code class="filename"><em class="replaceable"><code>package-1</code></em>.install</code>,
<code class="filename"><em class="replaceable"><code>package-2</code></em>.install</code>, vân vân.
</p>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="readme"/>5.1. <code class="filename">README.Debian</code></h2>
            </div>
          </div>
        </div>
        <p>
Bất kỳ chi tiết bổ sung hoặc sự khác biệt giữa gói gốc ban đầu và phiên bản
Debian của bạn nên được ghi lại ở đây
</p>
        <p>
<span class="command"><strong>dh_make</strong></span> đã tạo ra một tệp mặc định, giống như thế này:
</p>
        <pre class="screen">
gentoo for Debian
-----------------
&lt;possible notes regarding this package - if none, delete this file&gt;
 -- Josip Rodin &lt;joy-mg@debian.org&gt;, Wed, 11 Nov 1998 21:02:14 +0100
</pre>
        <p>
Nếu bạn không có gì để ghi chú, hãy xoá tệp này. Xem
<span class="citerefentry"><span class="refentrytitle">dh_installdocs</span>(1)</span>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="compat"/>5.2. <code class="filename">compat</code></h2>
            </div>
          </div>
        </div>
        <p>
Tệp <code class="filename">compat</code> định nghĩa mức độ tương thích với
<code class="systemitem">debhelper</code>.  Hiện tại, bạn nên để nó
là <code class="systemitem">debhelper</code> v9 như sau:
</p>
        <pre class="screen">
$ echo 9 &gt; debian/compat
</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="conffiles"/>5.3. <code class="filename">conffiles</code></h2>
            </div>
          </div>
        </div>
        <p>
Một trong những điều gây phiền phức nhất về phần mềm là khi bạn đã dành rất
nhiều thời gian và nỗ lực để cấu hình một chương trình, và khi nâng cấp phần
mềm thì mọi thay đổi của bạn bị đè.  Debian giải quyết vấn đề này bằng cách
gọi các tập tin cấu hình trong gói là conffiles.  <a href="#ftn.idm2067" class="footnote" id="idm2067"><sup class="footnote">[55]</sup></a> Khi bạn nâng cấp một gói, bạn sẽ được hỏi rằng bạn
có muốn giữ các tệp cấu hình cũ (hiện tại) hay không.
</p>
        <p>
<span class="citerefentry"><span class="refentrytitle">dh_installdeb</span>(1)</span> <span class="emphasis"><em>tự động</em></span> đánh
dâu bất kỳ tệp nào trong thư mục <code class="filename">/etc</code> là conffiles, vậy
nếu chương trình của bạn có conffiles ở đây, bạn không cần thiết phải thêm
chúng vào trong tệp này. Hầu hết các loại gói, nơi lưu trữ conffiles duy
nhất nên là <code class="filename">/etc</code>, và vì thế tệp này không cần thiết
phải tồn tại
</p>
        <p>
Nếu chương trình của bạn sử dụng các tệp cấu hình nhưng cũng viết lại chúng
như là cơ sở dư liệu, tốt nhất bạn không nên định nghĩa chúng là conffiles
vì ​​<span class="command"><strong>dpkg</strong></span> sẽ nhắc nhở người dùng xác minh các thay đổi
mọi lúc.
</p>
        <p>
Nếu chương trình bạn đang đóng gói đòi hỏi mỗi người dùng chỉnh sửa các tập
tin cấu hình trong thư mục <code class="filename">/etc</code>, có hai cách phổ biến
để định nghĩ chúng không phải là conffiles, giữ <span class="command"><strong>dpkg</strong></span> yên
tĩnh:
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
Tạo một liêt kết tượng trưng trong thư mục <code class="filename">/etc</code> trỏ tới
tệp ở thư mục <code class="filename">/var</code> được sinh ra bởi maintainer scripts.
</p>
            </li>
            <li class="listitem">
              <p>
Tạo một tệp bở maintainer scripts dưới thư mục <code class="filename">/etc</code>.
</p>
            </li>
          </ul>
        </div>
        <p>
Để biêt thêm thông tin về maintainer scripts, xem <a class="xref" href="dother.vi.html#maintscripts" title="5.18. {pre,post}{inst,rm}">Phần 5.18, “<code class="filename">{pre,post}{inst,rm}</code>”</a>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="crond"/>5.4. <code class="filename"><em class="replaceable"><code>package</code></em>.cron.*</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn yêu cầu các tác vụ được lên lịch thường xuyên để hoạt động
đúng, bạn có thể sử dụng các tệp này để làm điều đó. Bạn có thể thiết lập
các tác vụ thường xuyên hoặc xảy ra hàng giờ, hàng ngày, hàng tuần, hàng
tháng, hoặc bất cứ lúc nào bạn muốn.  Các tên tập tin là:
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.hourly</code> - Được
cài đặt tại
<code class="filename">/etc/cron.hourly/<em class="replaceable"><code>package</code></em></code>;
chạy mỗi giờ một lần.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.daily</code> - Được
cài đặt tại
<code class="filename">/etc/cron.daily/<em class="replaceable"><code>package</code></em></code>;
chạy mỗi ngày một lần.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.weekly</code> - Được
cài đặt tại
<code class="filename">/etc/cron.weekly/<em class="replaceable"><code>package</code></em></code>;
chạy mỗi tuần một lần.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.monthly</code> - Được
cài đặt tại
<code class="filename">/etc/cron.monthly/<em class="replaceable"><code>package</code></em></code>:
chạy mỗi tháng một lần.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.d</code> - Được cài
đặt tại <code class="filename">/etc/cron.d/<em class="replaceable"><code>package</code></em></code>:
cho bất kỳ thời gian khác.
</p>
            </li>
          </ul>
        </div>
        <p>
Hầu hết các tệp này là kịch bản shell, ngoại trừ tệp trong
<code class="filename"><em class="replaceable"><code>package</code></em>.cron.d</code> tuân thủ theo
định dạng của <span class="citerefentry"><span class="refentrytitle">crontab</span>(5)</span>.
</p>
        <p>
Không cần chỉ định tệp <code class="filename">cron.*</code> cho cài đặt ghi chép nhật
ký (log rotation); để làm điều này, xem
<span class="citerefentry"><span class="refentrytitle">dh_installlogrotate</span>(1)</span> and
<span class="citerefentry"><span class="refentrytitle">logrotate</span>(8)</span>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="dirs"/>5.5. <code class="filename">dirs</code></h2>
            </div>
          </div>
        </div>
        <p>
Tệp này chỉ định bất kỳ thư mục nào chúng ta cần nhưng không tạo theo quy
trình cài đặt thông thường (<code class="literal">make install DESTDIR=...</code> được
gọi bởi <code class="literal">dh_auto_install</code>).  Điều này có nghĩa sẽ có vấn đề
với <code class="filename">Makefile</code>.
</p>
        <p>
Các tệp này được liệt kê trong tệp <code class="filename">install</code> không cần
thư mục của chúng đuợc tạo trước.  Xem <a class="xref" href="dother.vi.html#install" title="5.11. install">Phần 5.11, “<code class="filename">install</code>”</a>.
</p>
        <p>
Tốt nhất là thử cài đặt trước và chỉ sửa dụng điều này nếu bạn gặp rắc
rối. Không có dấu gạch chéo trước tên thư mục được liệt kê trong
<code class="filename">dirs</code>
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="doc-base"/>5.6. <code class="filename"><em class="replaceable"><code>package</code></em>.doc-base</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn có tài liệu khác với trang hướng dẫn sử dụng và thông tin
(man, info), bạn nên sử dụng tệp <code class="systemitem">doc-base</code> để đăng ký, để người dùng có thể tìm
thấy nó bằng như:  <span class="citerefentry"><span class="refentrytitle">dhelp</span>(1)</span>, <span class="citerefentry"><span class="refentrytitle">dwww</span>(1)</span>, or <span class="citerefentry"><span class="refentrytitle">doccentral</span>(1)</span>.
</p>
        <p>
Thường bao gồm các tệp HTML, PS và PDF, được đặt tại
<code class="filename">/usr/share/doc/<em class="replaceable"><code>packagename</code></em>/</code>.
</p>
        <p>
Đây là tệp doc-base của gói <code class="systemitem">gentoo</code>
<code class="filename">gentoo.doc-base</code> trong giống như sau:
</p>
        <pre class="screen">
Document: gentoo
Title: Gentoo Manual
Author: Emil Brink
Abstract: This manual describes what Gentoo is, and how it can be used.
Section: File Management
Format: HTML
Index: /usr/share/doc/gentoo/html/index.html
Files: /usr/share/doc/gentoo/html/*.html
</pre>
        <p>
Thông tin về định dạng tệp tin này, xem <span class="citerefentry"><span class="refentrytitle">install-docs</span>(8)</span> và the Debian <code class="systemitem">doc-base</code> manual ở bản copy
<code class="filename">/usr/share/doc/doc-base/doc-base.html/index.html</code> trên máy của bạn  được cung cấp bởi gói
<code class="systemitem">doc-base</code> .
</p>
        <p>
Để biết thêm chi tiết về cài đặt tài liệu bổ sung, vui lòng xem <a class="xref" href="modify.vi.html#destdir" title="3.3. Cài đặt các tệp tin đến đích của chúng">Phần 3.3, “Cài đặt các tệp tin đến đích của chúng”</a>
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="docs"/>5.7. <code class="filename">docs</code></h2>
            </div>
          </div>
        </div>
        <p>
Tệp này chỉ định tên tệp của các tệp tài liệu mà chúng ta có thể
<span class="citerefentry"><span class="refentrytitle">dh_installdocs</span>(1)</span> cài đặt vào thư mục tạm thời cho
chúng.
</p>
        <p>
Mặc định, nó sẽ bao gồm tất cả các tệp tồn tại ở trong thư mục top-level
(không tính thư mục con) của mã nguồn bao gồm <code class="filename">BUGS</code>,
<code class="filename">README*</code>, <code class="filename">TODO</code> vân vân.
</p>
        <p>
Cho <code class="systemitem">gentoo</code>, vài tệp tin cũng được
bao gồm:
</p>
        <pre class="screen">
BUGS
CONFIG-CHANGES
CREDITS
NEWS
README
README.gtkrc
TODO
</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="emacsen"/>5.8. <code class="filename">emacsen-*</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn cung cấp các tệp Emacs có thể được cài tại thời điểm cài đặt
gói, bạn có thể sử dụng những tệp này để thiết lập nó.
</p>
        <p>
Chúng được cài đặt vào thư mục tạm thời bởi <span class="citerefentry"><span class="refentrytitle">dh_installemacsen</span>(1)</span>.
</p>
        <p>
Nếu bạn không cần, hãy xoá chúng đi
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="examples"/>5.9. <code class="filename"><em class="replaceable"><code>package</code></em>.examples</code></h2>
            </div>
          </div>
        </div>
        <p>
Lệnh <span class="citerefentry"><span class="refentrytitle">dh_installexamples</span>(1)</span> cài các tệp và thư mục được liệt kê
trong tệp này như là các tệp mẫu.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="initd"/>5.10. <code class="filename"><em class="replaceable"><code>package</code></em>.init</code> và
<code class="filename"><em class="replaceable"><code>package</code></em>.default</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn là một daemon cần được chạy tại thời điểm start-up của hệ
thống, bạn bỏ qua đề xuất ban đầu của mình, phải không ? 
</p>
        <p>
Tệp <code class="filename"><em class="replaceable"><code>package</code></em>.init</code> được cài
đặt vào kịch bản
<code class="filename">/etc/init.d/<em class="replaceable"><code>package</code></em></code> mà có
thể starts và stops tiếng trình daemon. Một bộ khung mẫu được cung cấp bởi
lệnh <span class="command"><strong>dh_make</strong></span> là <code class="filename">init.d.ex</code>.  Bạn sẽ
có thể phải đổi tên và chỉnh sửa nó, khá nhiều, trong khi đảm bảo cung cấp
header phù hợp với <a class="ulink" href="http://www.linuxfoundation.org/collaborate/workgroups/lsb">Linux Standard Base</a> (LSB). Nó
được cài đặt vào thư mục tạm thời bởi <span class="citerefentry"><span class="refentrytitle">dh_installinit</span>(1)</span>.
</p>
        <p>
Tệp <code class="filename"><em class="replaceable"><code>package</code></em>.default</code> sẽ được
cài đặt vào
<code class="filename">/etc/default/<em class="replaceable"><code>package</code></em></code>. Tệp
này cài đặt mặc định được sử dụng bởi kịch bản init.  Tệp
<code class="filename"><em class="replaceable"><code>package</code></em>.default</code> thường được
sử dụng để vô hiệu hoá một daemon đang chạy, hoặc cài đặt vài tuỳ chọn mặc
định hoặc độ trê.  Nếu kịch bản init của bạn có các tính năng cấu hình nhất
định, bạn có thể cài chúng vào
tệp<code class="filename"><em class="replaceable"><code>package</code></em>.default</code>, thay vì
viết trực tiếp vào chính kịch bản init.
</p>
        <p>
Nếu chương trình của bạn cung cấp một tệp cho kịch bản init, bạn cũng có thể
sử dụng nó hoặc không. Nếu bạn không sử dụng kịch bản init của họ thì hãy
tạo một tệp là
<code class="filename"><em class="replaceable"><code>package</code></em>.init</code>.  Tuy nhiên nếu
kịch bản init của thượng nguồn trông ổn và để đúng vị trí, bạn vẫn cần cài
đặt liên kết tượng trưng <code class="filename">rc*</code>. Để làm điểu này bạn cần
phải ghi đè <span class="command"><strong>dh_installinit</strong></span> trong tệp
<code class="filename">rules</code> với các dòng sau: 
</p>
        <pre class="screen">
override_dh_installinit:
        dh_installinit --onlyscripts
</pre>
        <p>
Nếu bạn không cần nó, hãy xoá những tệp này.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="install"/>5.11. <code class="filename">install</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu những tệp tin này cần được cài đặt vào trong gói của bạn nhưng
<code class="literal">make install</code> của bạn sẽ không làm điều đó. Vậy hãy đặt
các tên tập tin và đích của nó vào tệp <code class="filename">install</code> này,
chúng sẽ được cài đặt bởi
<span class="citerefentry"><span class="refentrytitle">dh_install</span>(1)</span>.<a href="#ftn.idm2263" class="footnote" id="idm2263"><sup class="footnote">[56]</sup></a> Bạn nên kiểm tra có hay không cách khác cụ thể hơn để sử dụng
trước. Ví dụ, các tài liệu nên đặt ở <code class="filename">docs</code> chứ không
phải trong tệp này.
</p>
        <p>
Mỗi dòng trong tệp <code class="filename">install</code> thể hiện cho mỗi tệp được
cài đặt, mỗi dòng bắt đầu với tên của tệp nguồn (tương đối với thư mục
build) sao đó một dấu cách (phím space) và tiếp theo là vị trí thư mục đích
sẽ được cài đặt (tương đối với thư mục cài đặt). Một ví dụ như tệp nhị phân
<code class="filename">src/<em class="replaceable"><code>bar</code></em></code> muốn cài đặt; tệp
<code class="filename">install</code> trông giống như sau:
</p>
        <pre class="screen">
src/<em class="replaceable"><code>bar</code></em> usr/bin
</pre>
        <p>
Nghĩa là khi gói này được cài đặt, sẽ có một lệnh thực thi ở
<code class="filename">/usr/bin/<em class="replaceable"><code>bar</code></em></code>.
</p>
        <p>
Ngoài ra, tệp <code class="filename">install</code> có thể chứa tên của tệp tin mà
không có thư mục đích để cài đặt khi thư mục tương đối không thay đổi. Định
dạng này thường được sử dụng cho một gói lớn phân chia đầu ra của gói của nó
thành nhiều gói nhị phân bằng cách sử dụng
<code class="filename"><em class="replaceable"><code>package-1</code></em>.install</code>,
<code class="filename"><em class="replaceable"><code>package-2</code></em>.install</code>, vân vân.
</p>
        <p>
Lệnh <span class="command"><strong>dh_install</strong></span> sẽ tìm laị trong thư mục
<code class="filename">debian/tmp</code>, nếu nó không tìm thấy chúng trong thư mục
hiện tại, (hoặc bạn đã nói với nó qua tuỳ chọn
<code class="literal">--sourcedir</code>).
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="info"/>5.12. <code class="filename"><em class="replaceable"><code>package</code></em>.info</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn có các trang thông tin, bạn nên cài chúng bởi <span class="citerefentry"><span class="refentrytitle">dh_installinfo</span>(1)</span> bằng cách liệt kê chúng trong tệp
<code class="filename"><em class="replaceable"><code>package</code></em>.info</code>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="links"/>5.13. <code class="filename"><em class="replaceable"><code>package</code></em>.links</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu bạn cần tạo các liên kết tượng trưng trong thư mục gói như người bảo trì
gói, bạn nên cài chúng bởi <span class="citerefentry"><span class="refentrytitle">dh_link</span>(1)</span> bằng cách liệt kê đường dẫn đầy đủ của nguồn và đích trong
tệp <code class="filename"><em class="replaceable"><code>package</code></em>.links</code>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="lintian"/>5.14. <code class="filename">{<em class="replaceable"><code>package</code></em>.,source/}lintian-overrides</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu chương trình <code class="systemitem">lintian</code> báo có một
chuẩn đoán về lỗi cho trường hợp khi Debian policy chấp nhận ngoại lệ cho
một số quy tắc, bạn có thể sử dụng tệp
<code class="filename"><em class="replaceable"><code>package</code></em>.lintian-overrides</code>
hoặc <code class="filename">source/lintian-overrides</code> để không còn báo lỗi từ
lintian. Vui lòng đọc Lintian User's Manual
(<code class="filename">https://lintian.debian.org/manual/index.html</code>) và tránh lạm dụng điều này.
</p>
        <p>
<code class="filename"><em class="replaceable"><code>package</code></em>.lintian-overrides</code>
cho gói nhị phân có tên là <code class="systemitem"><em class="replaceable"><code>package</code></em></code> và được cài
đặt vào
<code class="filename">usr/share/lintian/overrides/<em class="replaceable"><code>package</code></em></code>
bởi lệnh <span class="command"><strong>dh_lintian</strong></span>.
</p>
        <p>
<code class="filename">source/lintian-overrides</code> là cho gói nguồn. Nó không
phải cho cài đặt.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="manpage"/>5.15. <code class="filename">manpage.*</code></h2>
            </div>
          </div>
        </div>
        <p>
Các chương trình của bạn nên có một trang hướng dẫn (manual page). Nếu không
có, bạn  có thể tạo mới chúng. Lệnh <span class="command"><strong>dh_make</strong></span> tạo vài mẫu
tệp cho các trang hướng dẫn. Chúng cần được sao chép và chỉnh sửa cho mỗi
lệnh thiếu trong trang hưỡng dẫn. Vui lòng đảm bảo xoá các mẫu không sử
dụng.
</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="manpage1"/>5.15.1. <code class="filename">manpage.1.ex</code></h3>
              </div>
            </div>
          </div>
          <p>
Các trang hướng dẫn thường viết bằng <span class="citerefentry"><span class="refentrytitle">nroff</span>(1)</span>.  Mẫu <code class="filename">manpage.1.ex</code> cũng được viết bằng
<span class="command"><strong>nroff</strong></span>.  Xem trang hướng dẫn <span class="citerefentry"><span class="refentrytitle">man</span>(7)</span>
để biết mô tả ngắn gọn về cách chỉnh sửa tệp đó.
</p>
          <p>
Cuối cùng, tên của tệp trang hướng dẫn nên là tên của chương trình mà tệp đó
mô tả, vậy chúng ta sẽ đổi tên nó từ <code class="literal">manpage</code> thành
<code class="literal">gentoo</code>. Tên tệp cũng bao gồm <code class="literal">.1</code> là
đuôi cho loại một, điều đó có nghĩa là một trang hướng dẫn cho lệnh của
người dùng. Hãy chắc chắn xác minh rằng mục này chính xác.Đây là một danh
sách ngắn của các mục:
</p>
          <div class="informaltable">
            <a id="manpage-sections"/>
            <table class="informaltable" border="1">
              <colgroup>
                <col style="text-align: left"/>
                <col style="text-align: left"/>
                <col style="text-align: left"/>
              </colgroup>
              <thead>
                <tr>
                  <th style="text-align: left">Mục</th>
                  <th style="text-align: left">Mô tả</th>
                  <th style="text-align: left">Ghi chú</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="text-align: left">1</td>
                  <td style="text-align: left">Các lệnh người dùng</td>
                  <td style="text-align: left">Lệnh hoặc kịch bản thực thi</td>
                </tr>
                <tr>
                  <td style="text-align: left">2</td>
                  <td style="text-align: left">Lời gọi Hệ thống</td>
                  <td style="text-align: left">Chức năng được cung cấp từ nhân</td>
                </tr>
                <tr>
                  <td style="text-align: left">3</td>
                  <td style="text-align: left">Lời gọi Thư viện</td>
                  <td style="text-align: left">Chức năng trong thư viện hệ thống</td>
                </tr>
                <tr>
                  <td style="text-align: left">4</td>
                  <td style="text-align: left">Các tệp đặc biệt</td>
                  <td style="text-align: left">Thường xuyên là tệp tại <code class="filename">/dev</code></td>
                </tr>
                <tr>
                  <td style="text-align: left">5</td>
                  <td style="text-align: left">Định dạng tệp</td>
                  <td style="text-align: left">Ví dụ định dạng <code class="filename">/etc/passwd</code></td>
                </tr>
                <tr>
                  <td style="text-align: left">6</td>
                  <td style="text-align: left">Các trò chơi</td>
                  <td style="text-align: left">Trò chơi hoặc chương trình giải trí</td>
                </tr>
                <tr>
                  <td style="text-align: left">7</td>
                  <td style="text-align: left">Gói Macro</td>
                  <td style="text-align: left">Ví dụ như macros <span class="command"><strong>man</strong></span></td>
                </tr>
                <tr>
                  <td style="text-align: left">8</td>
                  <td style="text-align: left">Quản trị hệ thống</td>
                  <td style="text-align: left">Các chương trình chỉ thực thi bởi root</td>
                </tr>
                <tr>
                  <td style="text-align: left">9</td>
                  <td style="text-align: left">Chương trình của nhân</td>
                  <td style="text-align: left">Các lời gọi không theo chuẩn</td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>
Vì vậy trang man của <code class="systemitem">gentoo</code> nên được
gọi là <code class="filename">gentoo.1</code>. Nếu không có tệp
<code class="filename">gentoo.1</code> trong thượng nguồn, bạn nên tạo nó bằng cách
đổi tên template <code class="filename">manpage.1.ex</code> thành
<code class="filename">gentoo.1</code> và chỉnh sửa nó bằng cách sử dụng thông tin từ
các ví dụ và tài liệu thượng nguồn.
</p>
          <p>
Bạn có thể sử dụng lệnh <span class="command"><strong>help2man</strong></span> để tạo một manpage mới,
help2man sử dụng các dữ liệu từ tuỳ chọn <code class="literal">--help</code> và
<code class="literal">--version</code> của chương trình để tạo ra
manpage. <a href="#ftn.idm2411" class="footnote" id="idm2411"><sup class="footnote">[57]</sup></a>
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="manpagesgml"/>5.15.2. <code class="filename">manpage.sgml.ex</code></h3>
              </div>
            </div>
          </div>
          <p>
Mặt khác, nếu bạn thích viết SGML thay vì <span class="command"><strong>nroff</strong></span>, bạn có
thể sử dụng tệp mẫu <code class="filename">manpage.sgml.ex</code>.  Nếu bạn làm điều
này, bạn phải:
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
đổi tên tệp tin thành <code class="filename">gentoo.sgml</code>.
</p>
              </li>
              <li class="listitem">
                <p>
cài đặt gói <code class="systemitem">docbook-to-man</code>
</p>
              </li>
              <li class="listitem">
                <p>
thêm <code class="literal">docbook-to-man</code> vào dòng
<code class="literal">Build-Depends</code> của tệp <code class="filename">control</code>
</p>
              </li>
              <li class="listitem">
                <p>
thêm mục target <code class="literal">override_dh_auto_build</code> vào tệp
<code class="filename">rules</code>:
</p>
                <pre class="screen">
override_dh_auto_build:
        docbook-to-man debian/gentoo.sgml &gt; debian/gentoo.1
        dh_auto_build
</pre>
              </li>
            </ul>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="manpagexml"/>5.15.3. <code class="filename">manpage.xml.ex</code></h3>
              </div>
            </div>
          </div>
          <p>
Hoặc nếu bạn yêu thích XML hơn là SGML, bạn có thể sử dụng mẫu
<code class="literal">manpage.xml.ex</code> .  Nếu bạn làm điều này, bạn phải:
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
đổi tên thành <code class="literal">gentoo.1.xml</code>
</p>
              </li>
              <li class="listitem">
                <p>
cài đặt gói <code class="systemitem">docbook-xsl</code> và một XSLT
processor như <code class="systemitem">xsltproc</code> (khuyên dùng)
</p>
              </li>
              <li class="listitem">
                <p>
thêm tên các gói <code class="literal">docbook-xsl</code>,
<code class="literal">docbook-xml</code>, và <code class="literal">xsltproc</code> vào dòng
<code class="literal">Build-Depends</code> trong tệp <code class="literal">control</code>
</p>
              </li>
              <li class="listitem">
                <p>
thêm mục target <code class="literal">override_dh_auto_build</code> vào tệp
<code class="filename">rules</code>:
</p>
                <pre class="screen">
override_dh_auto_build:
        xsltproc --nonet \
         --param make.year.ranges 1 \
         --param make.single.year.ranges 1 \
         --param man.charmap.use.subset 0 \
         -o debian/ \
http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl\
        debian/gentoo.1.xml
        dh_auto_build
</pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="manpages"/>5.16. <code class="filename"><em class="replaceable"><code>package</code></em>.manpages</code></h2>
            </div>
          </div>
        </div>
        <p>
Nếu gói của bạn có các trang hướng dẫn, bạn nên cài đặt chúng bởi
<span class="citerefentry"><span class="refentrytitle">dh_installman</span>(1)</span> bằng cách liệt kê chúng trong tệp
<code class="filename"><em class="replaceable"><code>package</code></em>.manpages</code>.
</p>
        <p>
Để cài đặt <code class="filename">docs/gentoo.1</code> như một tệp manpage cho gói
<code class="systemitem">gentoo</code>, hãy tạo tệp
<code class="filename">gentoo.manpages</code> như sau:
</p>
        <pre class="screen">
docs/gentoo.1
</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="news"/>5.17. <code class="filename">NEWS</code></h2>
            </div>
          </div>
        </div>
        <p>
The <span class="citerefentry"><span class="refentrytitle">dh_installchangelogs</span>(1)</span> command installs this.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="maintscripts"/>5.18. <code class="filename">{pre,post}{inst,rm}</code></h2>
            </div>
          </div>
        </div>
        <p>
These <code class="filename">postinst</code>, <code class="filename">preinst</code>,
<code class="filename">postrm</code>, and <code class="filename">prerm</code> files
<a href="#ftn.idm2494" class="footnote" id="idm2494"><sup class="footnote">[58]</sup></a> are called <span class="emphasis"><em>maintainer
scripts</em></span>.  They are scripts which are put in the control area of
the package and run by <span class="command"><strong>dpkg</strong></span> when your package is
installed, upgraded, or removed.
</p>
        <p>
As a novice maintainer, you should avoid any manual editing of maintainer
scripts because they are problematic.  For more information refer to the
<a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html">Debian Policy Manual, 6 "Package
maintainer scripts and installation procedure"</a>, and take a look at
the example files provided by <span class="command"><strong>dh_make</strong></span>.
</p>
        <p>
If you did not listen to me and have created custom maintainer scripts for a
package, you should make sure to test them not only for <span class="strong"><strong>install</strong></span> and <span class="strong"><strong>upgrade</strong></span> but also for <span class="strong"><strong>remove</strong></span> and <span class="strong"><strong>purge</strong></span>.
</p>
        <p>
Upgrades to the new version should be silent and non-intrusive (existing
users should not notice the upgrade except by discovering that old bugs have
been fixed and perhaps that there are new features).
</p>
        <p>
When the upgrade is necessarily intrusive (eg., config files scattered
through various home directories with totally different structure), you may
consider as the last resort switching the package to a safe fallback state
(e.g., disabling a service) and providing the proper documentation required
by policy (<code class="filename">README.Debian</code> and
<code class="filename">NEWS.Debian</code>).  Don't bother the user with
<span class="command"><strong>debconf</strong></span> notes invoked from these maintainer scripts for
upgrades.
</p>
        <p>
The <code class="systemitem">ucf</code> package provides a
<span class="emphasis"><em>conffile-like</em></span> handling infrastructure to preserve user
changes for files that may not be labeled as <span class="emphasis"><em>conffiles</em></span>
such as those managed by the maintainer scripts.  This should minimize
issues associated with them.
</p>
        <p>
These maintainer scripts are among the Debian enhancements that explain
<span class="strong"><strong>why people choose Debian</strong></span>.  You must be
very careful not to turn them into a source of annoyance.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="symbols"/>5.19. <code class="filename"><em class="replaceable"><code>package</code></em>.symbols</code></h2>
            </div>
          </div>
        </div>
        <p>
Packaging of library is not easy for a novice maintainer and should be
avoided.  Having said it, if your package has libraries, you should have
<code class="filename">debian/<em class="replaceable"><code>package</code></em>.symbols</code>
files. See <a class="xref" href="advanced.vi.html#librarysymbols" title="A.2. Quản lý debian/package.symbols">Phần A.2, “Quản lý
<code class="filename">debian/<em class="replaceable"><code>package</code></em>.symbols</code>”</a>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="todo"/>5.20. <code class="filename">TODO</code></h2>
            </div>
          </div>
        </div>
        <p>
The <span class="citerefentry"><span class="refentrytitle">dh_installdocs</span>(1)</span> command installs this.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="watch"/>5.21. <code class="filename">watch</code></h2>
            </div>
          </div>
        </div>
        <p>
The <code class="filename">watch</code> file format is documented in the
<span class="citerefentry"><span class="refentrytitle">uscan</span>(1)</span> manpage.  The <code class="filename">watch</code> file configures the
<span class="command"><strong>uscan</strong></span> program (in the <code class="systemitem">devscripts</code> package) to watch the site where you
originally got the source from.  This is also used by the <a class="ulink" href="http://wiki.debian.org/DEHS">Debian External Health Status (DEHS)</a> service.
</p>
        <p>
Here are its contents:
</p>
        <pre class="screen">
# watch control file for uscan
version=3
http://sf.net/gentoo/gentoo-(.+)\.tar\.gz debian uupdate
</pre>
        <p>
Normally with a <code class="filename">watch</code> file, the URL at
<code class="literal">http://sf.net/gentoo</code> is downloaded and searched for links of
the form <code class="literal">&lt;a href=...&gt;</code>.  The basename (just the part
after the final <code class="literal">/</code>) of each linked URL is compared against
the Perl regular expression pattern (see <span class="citerefentry"><span class="refentrytitle">perlre</span>(1)</span>)  <code class="literal">gentoo-(.+)\.tar\.gz</code>.  Out of the files
that match, the one with the greatest version number is downloaded and the
<span class="command"><strong>uupdate</strong></span> program is run to create an updated source tree.
</p>
        <p>
Although this is true for other sites, the SourceForge download service at
<a class="ulink" href="http://sf.net">http://sf.net</a> is an exception.  When the
<code class="filename">watch</code> file has an URL matching the Perl regexp
<code class="literal">^http://sf\.net/</code>, the <span class="command"><strong>uscan</strong></span> program
replaces it with <code class="literal">http://qa.debian.org/watch/sf.php/</code> and then applies
this rule.  The URL redirector service at <a class="ulink" href="http://qa.debian.org/">http://qa.debian.org/</a> is designed
to offer a stable redirect service to the desired file for any
<code class="filename">watch</code> pattern of the form
<code class="literal">http://sf.net/<em class="replaceable"><code>project</code></em>/<em class="replaceable"><code>tar-name</code></em>-(.+)\.tar\.gz</code>.
This solves issues related to periodically changing SourceForge URLs.
</p>
        <p>
If the upstream offers the cryptographic signature of the tarball, it is
recommended to verify its authenticity using the
<code class="literal">pgpsigurlmangle</code> option as described in <span class="citerefentry"><span class="refentrytitle">uscan</span>(1)</span>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="sourcef"/>5.22. <code class="filename">source/format</code></h2>
            </div>
          </div>
        </div>
        <p>
In the <code class="filename">debian/source/format</code> file, there should be a
single line indicating the desired format for the source package (check
<span class="citerefentry"><span class="refentrytitle">dpkg-source</span>(1)</span> for an exhaustive list).  After
<code class="literal">squeeze</code>, it should say either:
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
<code class="literal">3.0 (native)</code> for native Debian packages or
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">3.0 (quilt)</code> for everything else.
</p>
            </li>
          </ul>
        </div>
        <p>
The newer <code class="literal">3.0 (quilt)</code> source format records modifications
in a <span class="command"><strong>quilt</strong></span> patch series within
<code class="filename">debian/patches</code>.  Those changes are then automatically
applied during extraction of the source package.  <a href="#ftn.idm2595" class="footnote" id="idm2595"><sup class="footnote">[59]</sup></a> The Debian modifications are simply stored in a
<code class="filename">debian.tar.gz</code> archive containing all files under the
<code class="filename">debian</code> directory.  This new format supports inclusion
of binary files such as PNG icons by the package maintainer without
requiring tricks.  <a href="#ftn.idm2602" class="footnote" id="idm2602"><sup class="footnote">[60]</sup></a>
</p>
        <p>
When <span class="command"><strong>dpkg-source</strong></span> extracts a source package in
<code class="literal">3.0 (quilt)</code> source format, it automatically applies all
patches listed in <code class="filename">debian/patches/series</code>.  You can avoid
applying patches at the end of the extraction with the
<code class="literal">--skip-patches</code> option.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="sourcel"/>5.23. <code class="filename">source/local-options</code></h2>
            </div>
          </div>
        </div>
        <p>
When you want to manage Debian packaging activities under a VCS, you
typically create one branch (e.g.  <code class="literal">upstream</code>) tracking the
upstream source and another branch (e.g.  typically
<code class="literal">master</code> for Git)  tracking the Debian package.  For the
latter, you usually want to have unpatched upstream source with your
<code class="filename">debian/*</code> files for the Debian packaging to ease merging
of the new upstream source.
</p>
        <p>
After you build a package, the source is normally left patched.  You need to
unpatch it manually by running <code class="literal">dquilt pop -a</code> before
committing to the <code class="literal">master</code> branch.  You can automate this
by adding the optional <code class="filename">debian/source/local-options</code> file
containing <code class="literal">unapply-patches</code>.  This file is not included in
the generated source package and changes the local build behavior only.
This file may contain <code class="literal">abort-on-upstream-changes</code>, too (see
<span class="citerefentry"><span class="refentrytitle">dpkg-source</span>(1)</span>).
</p>
        <pre class="screen">
unapply-patches
abort-on-upstream-changes
</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="sourceopt"/>5.24. <code class="filename">source/options</code></h2>
            </div>
          </div>
        </div>
        <p>
The autogenerated files in the source tree can be quite annoying for
packaging since they generate meaningless large patch files.  There are
custom modules such as <span class="command"><strong>dh_autoreconf</strong></span> to ease this problem
as described in <a class="xref" href="dreq.vi.html#customrules" title="4.4.3. Tuỳ chỉnh tệp rules">Phần 4.4.3, “Tuỳ chỉnh tệp <code class="filename">rules</code>”</a>.
</p>
        <p>
You can provide a Perl regular expression to the
<code class="literal">--extend-diff-ignore</code> option argument of <span class="citerefentry"><span class="refentrytitle">dpkg-source</span>(1)</span> to ignore changes made to the autogenerated files while
creating the source package.
</p>
        <p>
As a general solution to address this problem of the autogenerated files,
you can store such a <span class="command"><strong>dpkg-source</strong></span> option argument in the
<code class="filename">source/options</code> file of the source package.  The
following will skip creating patch files for
<code class="filename">config.sub</code>, <code class="filename">config.guess</code>, and
<code class="filename">Makefile</code>.
</p>
        <pre class="screen">
extend-diff-ignore = "(^|/)(config\.sub|config\.guess|Makefile)$"
</pre>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="patches"/>5.25. <code class="filename">patches/*</code></h2>
            </div>
          </div>
        </div>
        <p>
The old <code class="literal">1.0</code> source format created a single large
<code class="filename">diff.gz</code> file containing package maintenance files in
<code class="filename">debian</code> and patch files for the source.  Such a package
is a bit cumbersome to inspect and understand for each source tree
modification later.  This is not so nice.
</p>
        <p>
The newer <code class="literal">3.0 (quilt)</code> source format stores patches in
<code class="filename">debian/patches/*</code> files using the
<span class="command"><strong>quilt</strong></span> command.  These patches and other package data
which are all contained under the <code class="filename">debian</code> directory are
packaged as the <code class="filename">debian.tar.gz</code> file.  Since the
<span class="command"><strong>dpkg-source</strong></span> command can handle <span class="command"><strong>quilt</strong></span>
formatted patch data in the <code class="literal">3.0 (quilt)</code> source without
the <code class="systemitem">quilt</code> package, it does not need
a <code class="literal">Build-Depends</code> on <code class="systemitem">quilt</code>.  <a href="#ftn.idm2663" class="footnote" id="idm2663"><sup class="footnote">[61]</sup></a>
</p>
        <p>
The <span class="command"><strong>quilt</strong></span> command is explained in <span class="citerefentry"><span class="refentrytitle">quilt</span>(1)</span>.  It records modifications to the source as a stack of
<code class="literal">-p1</code> patch files in the
<code class="filename">debian/patches</code> directory and the source tree is
untouched outside of the <code class="filename">debian</code> directory.  The order
of these patches is recorded in the
<code class="filename">debian/patches/series</code> file.  You can apply (=push),
un-apply (=pop), and refresh patches easily.  <a href="#ftn.idm2679" class="footnote" id="idm2679"><sup class="footnote">[62]</sup></a>
</p>
        <p>
For <a class="xref" href="modify.vi.html" title="Chương 3. Sửa đổi mã nguồn">Chương 3, <em>Sửa đổi mã nguồn</em></a>, we created three patches in
<code class="filename">debian/patches</code>.
</p>
        <p>
Since Debian patches are located in <code class="filename">debian/patches</code>,
please make sure to set up the <span class="command"><strong>dquilt</strong></span> command properly as
described in <a class="xref" href="modify.vi.html#quiltrc" title="3.1. Cài đặt quilt">Phần 3.1, “Cài đặt <span class="command"><strong>quilt</strong></span>”</a>.
</p>
        <p>
When anyone (including yourself) provides a patch
<code class="filename"><em class="replaceable"><code>foo</code></em>.patch</code> to the source
later, modifying a <code class="literal">3.0 (quilt)</code> source package is quite
simple:
</p>
        <pre class="screen">
$ dpkg-source -x gentoo_0.9.12.dsc
$ cd gentoo-0.9.12
$ dquilt import ../<em class="replaceable"><code>foo</code></em>.patch
$ dquilt push
$ dquilt refresh
$ dquilt header -e
... describe patch
</pre>
        <p>
The patches stored in the newer <code class="literal">3.0 (quilt)</code> source format
must be <span class="emphasis"><em>fuzz</em></span> free.  You can ensure this with
<code class="literal">dquilt pop -a; while dquilt push; do dquilt refresh;
done</code>.
</p>
      </div>
      <div class="footnotes">
        <br/>
        <hr/>
        <div id="ftn.idm2006" class="footnote">
          <p><a href="#idm2006" class="para"><sup class="para">[54] </sup></a>
Trong chương này, các tệp tin trong thư mục <code class="filename">debian</code> được
đề cập đến mà không có <code class="filename">debian/</code> để đơn giản hóa bất cứ
khi nhắc tới.
</p>
        </div>
        <div id="ftn.idm2067" class="footnote">
          <p><a href="#idm2067" class="para"><sup class="para">[55] </sup></a>Xem <span class="citerefentry"><span class="refentrytitle">dpkg</span>(1)</span> và <a class="ulink" href="http://www.debian.org/doc/debian-policy/ap-pkg-controlfields.html#s-pkg-f-Conffiles">Debian Policy Manual, "D.2.5 Conffiles"</a>.
</p>
        </div>
        <div id="ftn.idm2263" class="footnote">
          <p><a href="#idm2263" class="para"><sup class="para">[56] </sup></a> Tệp này sẽ thay thế lệnh <span class="citerefentry"><span class="refentrytitle">dh_movefiles</span>(1)</span> không được dùng nữa, được cấu hình bởi tệp
<code class="filename">files</code> .  </p>
        </div>
        <div id="ftn.idm2411" class="footnote">
          <p><a href="#idm2411" class="para"><sup class="para">[57] </sup></a> Lưu ý rằng lệnh <span class="command"><strong>help2man</strong></span>sẽ yêu cầu nhiều tài liệu chi
tiết hơn có sẵn trong hệ thống info. Nếu thiếu lệnh này trong trang
<span class="command"><strong>info</strong></span>, bạn nên tạo nó bằng cách sử dụng lệnh
<span class="command"><strong>help2man</strong></span>.  </p>
        </div>
        <div id="ftn.idm2494" class="footnote">
          <p><a href="#idm2494" class="para"><sup class="para">[58] </sup></a> Despite this use of the <span class="command"><strong>bash</strong></span> shorthand expression
<code class="filename">{pre,post}{inst,rm}</code> to indicate these filenames, you
should use pure POSIX syntax for these maintainer scripts for compatibility
with <span class="command"><strong>dash</strong></span> as the system shell.  </p>
        </div>
        <div id="ftn.idm2595" class="footnote">
          <p><a href="#idm2595" class="para"><sup class="para">[59] </sup></a> See <a class="ulink" href="http://wiki.debian.org/Projects/DebSrc3.0">DebSrc3.0</a> for a summary on the switch to
the new <code class="literal">3.0 (quilt)</code> and <code class="literal">3.0 (native)</code>
source formats.  </p>
        </div>
        <div id="ftn.idm2602" class="footnote">
          <p><a href="#idm2602" class="para"><sup class="para">[60] </sup></a>Actually, this new format also supports multiple upstream tarballs and more
compression methods.  These are beyond the scope of this document.</p>
        </div>
        <div id="ftn.idm2663" class="footnote">
          <p><a href="#idm2663" class="para"><sup class="para">[61] </sup></a> Several methods of patch set maintenance have been proposed and are in use
for Debian packages.  The <span class="command"><strong>quilt</strong></span> system is the preferred
maintenance system in use.  Others include <span class="command"><strong>dpatch</strong></span>,
<span class="command"><strong>dbs</strong></span>, and <span class="command"><strong>cdbs</strong></span>.  Many of these keep
such patches as <code class="filename">debian/patches/*</code> files.  </p>
        </div>
        <div id="ftn.idm2679" class="footnote">
          <p><a href="#idm2679" class="para"><sup class="para">[62] </sup></a> If you are asking a sponsor to upload your package, this kind of clear
separation and documentation of your changes is very important to expedite
the package review by your sponsor.  </p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td align="left"><a accesskey="p" href="dreq.vi.html"><img src="images/prev.png" alt="Trước đó"/></a> </td>
          <td align="center"> </td>
          <td align="right"> <a accesskey="n" href="build.vi.html"><img src="images/next.png" alt="Kế tiếp"/></a></td>
        </tr>
        <tr>
          <td align="left" valign="top">Chương 4. Các tệp yêu cầu trong thư mục <code class="filename">debian</code> </td>
          <td align="center">
            <a accesskey="h" href="index.vi.html">
              <img src="images/home.png" alt="Đầu"/>
            </a>
          </td>
          <td align="right" valign="top"> Chương 6. Biên dịch gói</td>
        </tr>
      </table>
    </div>
  </body>
</html>
