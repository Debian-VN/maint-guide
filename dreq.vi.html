<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Chương 4. Các tệp yêu cầu trong thư mục debian</title>
    <link rel="stylesheet" type="text/css" href="debian.css"/>
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="home" href="index.vi.html" title="Debian New Maintainers' Guide"/>
    <link rel="up" href="index.vi.html" title="Debian New Maintainers' Guide"/>
    <link rel="prev" href="modify.vi.html" title="Chương 3. Sửa đổi mã nguồn"/>
    <link rel="next" href="dother.vi.html" title="Chương 5. Other files under the debian directory"/>
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Chương 4. Các tệp yêu cầu trong thư mục <code class="filename">debian</code></th>
        </tr>
        <tr>
          <td align="left"><a accesskey="p" href="modify.vi.html"><img src="images/prev.png" alt="Trước đó"/></a> </td>
          <th width="60%" align="center"> </th>
          <td align="right"> <a accesskey="n" href="dother.vi.html"><img src="images/next.png" alt="Kế tiếp"/></a></td>
        </tr>
      </table>
      <hr/>
    </div>
    <div class="chapter">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a id="dreq"/>Chương 4. Các tệp yêu cầu trong thư mục <code class="filename">debian</code></h1>
          </div>
        </div>
      </div>
      <div class="toc">
        <p>
          <strong>Mục lục</strong>
        </p>
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="dreq.vi.html#control">4.1. <code class="filename">control</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dreq.vi.html#copyright">4.2. <code class="filename">copyright</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dreq.vi.html#changelog">4.3. <code class="filename">changelog</code></a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dreq.vi.html#rules">4.4. <code class="filename">rules</code></a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="dreq.vi.html#targets">4.4.1. Targets of the <code class="filename">rules</code> file</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dreq.vi.html#defaultrules">4.4.2. Default <code class="filename">rules</code> file</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dreq.vi.html#customrules">4.4.3. Customization of <code class="filename">rules</code> file</a>
                </span>
              </dt>
            </dl>
          </dd>
        </dl>
      </div>
      <p>
Có một thư mục con mới trong thư mục nguồn của chương trình được gọi là
<code class="filename">debian</code>. Có một số tệp tin trong thư mục này mà chúng ta
nên sửa đổi để các tuỳ chỉnh hành vi của gói.  Các tệp quan trọng trong số
chúng là <code class="filename">control</code>, <code class="filename">changelog</code>,
<code class="filename">copyright</code>, và <code class="filename">rules</code>, chúng là
những tệp yêu cầu đối với tất cả các gói <a href="#ftn.idm1156" class="footnote" id="idm1156"><sup class="footnote">[27]</sup></a>
</p>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="control"/>4.1. <code class="filename">control</code></h2>
            </div>
          </div>
        </div>
        <p>
Tập tin này chứa các giá trị khác nhau mà <span class="command"><strong>dpkg</strong></span>,
<span class="command"><strong>dselect</strong></span>, <span class="command"><strong>apt-get</strong></span>,
<span class="command"><strong>apt-cache</strong></span>, <span class="command"><strong>aptitude</strong></span>, và các công cụ
quản lý gói khác sẽ sử dụng để quản lý gói. Nó được xác định bởi <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-controlfields.html">Debian Policy Manual, 5 "Control files and their
fields"</a>
</p>
        <p>
Đây là tệp <code class="filename">control</code> mà <span class="command"><strong>dh_make</strong></span> tạo ra
cho chúng ta:
</p>
        <pre class="screen">
 1 Source: gentoo
 2 Section: unknown
 3 Priority: extra
 4 Maintainer: Josip Rodin &lt;joy-mg@debian.org&gt;
 5 Build-Depends: debhelper (&gt;=9)
 6 Standards-Version: 3.9.4
 7 Homepage: &lt;insert the upstream URL, if relevant&gt;
 8
 9 Package: gentoo
10 Architecture: any
11 Depends: ${shlibs:Depends}, ${misc:Depends}
12 Description: &lt;insert up to 60 chars description&gt;
13  &lt;insert long description, indented with spaces&gt;
</pre>
        <p>
(Tôi đã thêm các số dòng.)
</p>
        <p>
Dòng 1-7 là thông tin điều khiển cho gói nguồn. Dòng 9-13 là thông tin điều
khiển cho gói nhị phân.
</p>
        <p>
Dòng 1 là tên của gói nguồn
</p>
        <p>
Dòng 2 là các mục loại mục chương trình
</p>
        <p>
Như bạn có thể nhận thấy, kho phần mềm Debian được chia làm nhiều khu vục:
<code class="literal">main</code> (phần mềm tự do), <code class="literal">non-free</code> (thật
sự không phải phẩn mềm tự do) and <code class="literal">contrib</code> (phần mềm tự do
phụ thuộc vào phần mềm không tự do). Mỗi loại được chi thánh các phần danh
mục. Vậy chúng ta có <code class="literal">admin</code> cho các chương trình quản trị,
<code class="literal">devel</code> cho các công cụ phát triển, <code class="literal">doc</code>
cho tài liệu, <code class="literal">libs</code> cho thư viện, <code class="literal">mail</code>
cho chương trình liên quan thư điện tử, <code class="literal">net</code> cho ứng dụng
mạng và chaỵ nền, <code class="literal">x11</code> cho các chương trình X11 khác, và
nhiều nữa.  <a href="#ftn.idm1189" class="footnote" id="idm1189"><sup class="footnote">[28]</sup></a>
</p>
        <p>
Chúng ta hãy thay đổi nó thành x11. (Tiền tố <code class="literal">main/</code> với
ngụ ý là chúng ta có thể bỏ qua nó).
</p>
        <p>
Dòng 3 miêu tả mức độ quan trọng của việc ngươì dùng cài đặt gói này.
<a href="#ftn.idm1197" class="footnote" id="idm1197"><sup class="footnote">[29]</sup></a>
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
Ưu tiên <code class="literal">optional</code> thường sẽ làm việc với gói mới mà không
xung đột với các gói chứa ưu tiên <code class="literal">required</code>,
<code class="literal">important</code>, hay <code class="literal">standard</code> .
</p>
            </li>
            <li class="listitem">
              <p>
Ưu tiên <code class="literal">extra</code> thường sẽ làm việc với gói mới mà xung dột
với các ưu tiên non-<code class="literal">extra</code> priorities.
</p>
            </li>
          </ul>
        </div>
        <p>
Trường Section và Priority được sử dụng bởi các chương trình front-ends như
<span class="command"><strong>aptitude</strong></span> khi họ sắp xếp gói và chọn mặc định. Khi bạn tải
gói lên Debian, giá trị của hai trường này có thể bị ghi đè bởi các nhà bảo
trì kho lưu trữ, trong trường hợp đó bạn sẽ được thông báo bằng email.
</p>
        <p>
Vì đây là gói ưu tiên thông thường và không xung đột với bất kỳ điều gì
khác, chúng tôi sẽ thay đổi mức độ ưu tiên thành
<code class="literal">optional</code>.
</p>
        <p>
Dòng 4 là tên và địa chỉ email của người bảo trì. Hãy đảm bảo rằng trường
này có tiêu đề <code class="literal">To</code> hợp lệ cho email, bởi vì sau khi tải
lên, hệ thống theo dõi lỗi sẽ sử dụng chính trường này để gửi email lỗi cho
bạn. Tránh sử dụng dấu phẩy, ký hiệu, hoặc dấu ngoặc đơn.
</p>
        <p>
Dòng 5 là trưởng <code class="literal">Build-Depends</code>  bao gồm danh sách của các
gói yêu cầu để xây dựng gói của bạn. Bạn cũng có thể  có thêm trường
<code class="literal">Build-Depends-Indep</code> bổ sung.  <a href="#ftn.idm1220" class="footnote" id="idm1220"><sup class="footnote">[30]</sup></a>. Một số gói như <code class="systemitem">gcc</code> và <code class="systemitem">make</code> là yêu cầu ngầm định bởi gói  <code class="systemitem">build-essential</code> Nếu bạn cần có các công cụ khác
để xây dựng gói của mình, bạn nên thêm chúng vào các trường này. Nhiều mục
được phân cách bằng dấu phẩy; Hãy đọc tiếp để hiểu rõ hơn về các phụ thuộc
gói nhị phân.
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
Đối với tất cả các gói đóng gói với lệnh <span class="command"><strong>dh</strong></span> trong tệp tin
<code class="filename">debian/rules</code>, bạn phải có
<code class="literal">debhelper(&gt;=9)</code> trong trường
<code class="literal">Build-Depends</code> để thỏa mãn yêu cầu Chính sách Debian đối
với mục <code class="literal">clean</code>.
</p>
            </li>
            <li class="listitem">
              <p>
Gói nguồn có gói nhị phân với <code class="literal">Architecture: any</code> được xây
dựng lại bởi autobuilder. Vì thủ tục autobuilder này chỉ cài đặt các gói
được liệt kê trong trường <code class="literal">Build-Depends</code> trước khi chạy
<code class="literal">debian/rules build</code> (see <a class="xref" href="build.vi.html#autobuilder" title="6.2. Tự động biên dịch">Phần 6.2, “Tự động biên dịch”</a>),
Trường <code class="literal">Build-Depends</code> rất cần thiết để liệt kê tất cả các
gói cần thiết còn <code class="literal">Build-Depends-Indep</code> hiếm khi được sử
dụng.
</p>
            </li>
            <li class="listitem">
              <p>
Đối với các gói nguồn với các gói nhị phân có kiến trúc
<code class="literal">Architecture: all</code>, trường
<code class="literal">Build-Depends-Indep</code> có thể liệt kê tất cả các gói cần
thiết trừ khi chúng đã được liệt kê trong trường
<code class="literal">Build-Depends</code> để thỏa mãn yêu cầu của Chính sách Debian
đối với mục <code class="literal">clean</code>.
</p>
            </li>
          </ul>
        </div>
        <p>
Nếu bạn không chắc chắn nên sử dụng trường nào, hãy sử dụng trường
<code class="literal">Build-Depends</code> để an toàn.  <a href="#ftn.idm1250" class="footnote" id="idm1250"><sup class="footnote">[31]</sup></a>
</p>
        <p>
Để tìm ra những gói nào cần để xây dựng chương trình của bạn:
</p>
        <pre class="screen">
$ dpkg-depcheck -d ./configure
</pre>
        <p>
Để tự tìm chính xác các phụ thuộc khi xây dựng
<span class="command"><strong><em class="replaceable"><code>/usr/bin/foo</code></em></strong></span>, thực hiện
</p>
        <pre class="screen">
$ objdump -p <em class="replaceable"><code>/usr/bin/foo</code></em> | grep NEEDED
</pre>
        <p>
và cho mỗi thư viện được liệt kê, ví dụ: <span class="command"><strong>libfoo.so.6</strong></span>,
thực hiện
</p>
        <pre class="screen">
$ dpkg -S libfoo.so.6
</pre>
        <p>
Sau đó chỉ cần lấy phiên bản <code class="literal">-dev </code> của mỗi gói như một
mục nhập <code class="literal">Build-Depends</code>.  Nếu bạn sử dụng
<span class="command"><strong>ldd</strong></span> cho mục đích này, nó sẽ báo cáo phụ thuộc lib gián
tiếp, kết quả là 
</p>
        <p>
<code class="systemitem">gentoo</code> yêu cầu <code class="systemitem">xlibs-dev</code>, <code class="systemitem">libgtk1.2-dev</code> and <code class="systemitem">libglib1.2-dev</code> để xây dựng, vâỵ nên chúng ta sẽ
thêm chúng vào vị trí tiếp theo <code class="systemitem">debhelper</code>.
</p>
        <p>
Dòng 6 là phiên bản của <a class="ulink" href="http://www.debian.org/doc/devel-manuals#policy">Debian Policy
Manual</a>mà phần mềm này tuân theo, một trong tài liệu bạn đọc trong
khi xây dựng gói của bạn.
</p>
        <p>
Trên dòng 7, bạn có thể đặt URL của trang chủ thượng nguồn của phần mềm
</p>
        <p>
Dòng 9 là tên của gói nhị phân. Nó thường giống với tên của gói nguồn, nhưng
nó không nhất thiết phải giống nhau.
</p>
        <p>
Dòng 10 mô tả các kiến ​​trúc mà gói nhị phân có thể được biên dịch.  Giá
trị này thường là một trong các tùy chọn sau, tùy thuộc vào loại gói nhị
phân: <a href="#ftn.idm1282" class="footnote" id="idm1282"><sup class="footnote">[32]</sup></a>
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
                <code class="literal">Architecture: any</code>
              </p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <p>Gói nhị phân được tạo ra là một kiến ​​trúc phụ thuộc thường là các chương
trình xây dựng bằng ngôn ngữ biên dịch.</p>
                  </li>
                </ul>
              </div>
            </li>
            <li class="listitem">
              <p>
                <code class="literal">Architecture: all</code>
              </p>
              <div class="itemizedlist">
                <ul class="itemizedlist">
                  <li class="listitem">
                    <p>Gói nhị phân được tạo ra là một kiến ​​trúc độc lập thường bao gồm các văn
bản, hình ảnh hoặc các tập lệnh theo ngôn ngữ kịch bản.</p>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
        <p>
Chúng ta để lại dòng 10 vì nó được viết bằng
C.
<span class="citerefentry"><span class="refentrytitle">dpkg-gencontrol</span>(1)</span>
sẽ tự điền vào trường Architecture một cách thích hợp cho bất kỳ máy nào gói
nguồn này được biên soạn.
</p>
        <p>
Nếu gói của bạn là kiến ​​trúc độc lập (ví dụ: mã shell hoặc kịch bản Perl,
hoặc tài liệu), hãy thay đổi điều này thành <code class="literal">all</code> và đọc
<a class="xref" href="dreq.vi.html#rules" title="4.4. rules">Phần 4.4, “<code class="filename">rules</code>”</a> về <code class="literal">binary-indep</code> thay vì
<code class="literal">binary-arch</code> để xây dựng gói.
</p>
        <p>
Dòng 11 cho thấy một trong những tính năng mạnh mẽ nhất của hệ thống đóng
gói Debian. Gói có thể liên quan đến nhau theo nhiều cách khác nhau.  Ngoài
<code class="literal">Depends</code>, các trường mối quan hệ khác là
<code class="literal">Recommends</code>, <code class="literal">Suggests</code>,
<code class="literal">Pre-Depends</code>, <code class="literal">Breaks</code>,
<code class="literal">Conflicts</code>, <code class="literal">Provides</code> và
<code class="literal">Replaces</code>.
</p>
        <p>
Các công cụ quản lý gói thường có chung hành vi khi đọc các mối quan hệ này;
Nếu không, nó sẽ được giải thích. (See <span class="citerefentry"><span class="refentrytitle">dpkg</span>(8)</span>, <span class="citerefentry"><span class="refentrytitle">dselect</span>(8)</span>, <span class="citerefentry"><span class="refentrytitle">apt</span>(8)</span>,
<span class="citerefentry"><span class="refentrytitle">aptitude</span>(1)</span>, etc.)
</p>
        <p>
Đây là mô tả đơn giản về các mối quan hệ của gói: <a href="#ftn.idm1330" class="footnote" id="idm1330"><sup class="footnote">[33]</sup></a>
</p>
        <div class="itemizedlist">
          <ul class="itemizedlist">
            <li class="listitem">
              <p>
<code class="literal">Depends</code>
</p>
              <p>
Gói của bạn sẽ không được cài đặt trừ khi các gói phụ thuộc được cài đặt. Sử
dụng trường này nếu chương trình của bạn hoàn toàn không chạy (hoặc sẽ gây
ra sự cố nghiêm trọng) trừ khi một gói cụ thể có mặt.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Recommends</code>
</p>
              <p>
Sử dụng trường này cho cho các gói không bắt buộc nhưng thường được sử dụng
kèm với chương trình của bạn.  Khi người dùng cài đặt chương trình của bạn,
các công cụ quản lý gói có thể sẽ nhắc cài đặt gói đề
xuất. <span class="command"><strong>aptitude</strong></span> và <span class="command"><strong>apt-get</strong></span> cài đặt các
gói được đề xuất cùng với gói của bạn theo mặc định (nhưng người dùng có thể
vô hiệu hóa hành vi này). <span class="command"><strong>dpkg</strong></span> sẽ bỏ qua trường này.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Suggests</code>
</p>
              <p>
Sử dụng trường này cho các gói sẽ hoạt động tốt với chương trình của bạn
nhưng không cần thiết. Khi người dùng cài đặt chương trình của bạn, họ sẽ
không được nhắc nhở để cài đặt gói đề xuất.  <span class="command"><strong>aptitude</strong></span> có
thể được cấu hình để cài đặt các gói đề xuất cùng với gói của bạn nhưng đây
không phải là mặc định. <span class="command"><strong>dpkg</strong></span> và
<span class="command"><strong>apt-get</strong></span> sẽ bỏ qua trường này.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Pre-Depends</code>
</p>
              <p>
Trường này mạnh hơn <code class="literal">Depends</code>. Gói sẽ không được cài đặt
trừ khi các gói mà nó được phụ thuộc trước được cài đặt và <span class="emphasis"><em>được
cấu hình chính xác</em></span>. Sử dụng điều này một cách
<span class="emphasis"><em>rất</em></span> tỉ mỉ và chỉ sau khi thảo luận về nó trên danh sách
gửi thư <a class="ulink" href="http://lists.debian.org/debian-devel/">debian-devel@lists.debian.org
</a>. Đọc: đừng sử dụng nó.:-)
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Conflicts</code>
</p>
              <p>
Gói sẽ không được cài đặt cho đến khi tất cả các gói xung đột đã được gỡ
bỏ. Sử dụng này nếu chương trình của bạn hoàn toàn không chạy hoặc sẽ gây ra
những vấn đề nghiêm trọng nếu một gói cụ thể có mặt.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Breaks</code>
</p>
              <p>
Khi cài đặt gói nó sẽ phá vỡ tất cả các gói được liệt kê. Thông thường
trường <code class="literal">Breaks</code> chỉ định áp dụng các phiên bản sớm hơn một
giá trị nhất định.  Nói chung là sử dụng các công cụ quản lý gói cấp cao để
nâng cấp các gói được liệt kê.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Provides</code>
</p>
              <p>
Đối với một số loại gói có nhiều tên ảo khác đã được xác định. Bạn có thể có
một danh sách đầy đủ trong tệp <a class="ulink" href="http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt">virtual-package-names-list.txt.gz </a>. Sử dụng
điều này nếu chương trình của bạn cung cấp một chức năng của một gói ảo hiện
có.
</p>
            </li>
            <li class="listitem">
              <p>
<code class="literal">Replaces</code>
</p>
              <p>
Sử dụng điều này khi chương trình của bạn thay thế các tệp từ một gói khác
hoặc thay thế hoàn toàn một gói khác (được sử dụng kết hợp với
<code class="literal">Conflicts</code>). Các tệp từ các gói có tên sẽ được ghi đè bằng
các tệp từ gói của bạn.
</p>
            </li>
          </ul>
        </div>
        <p>
Tất cả các trường này có cú pháp thống nhất.  Họ là một danh sách các tên
gói được phân cách bằng dấu phẩy. Các tên gói này cũng có thể là danh sách
các tên gói thay thế, được phân cách bằng ký hiệu thanh dọc
<code class="literal">|</code> (biểu tượng ống).
</p>
        <p>
Các trường có thể hạn chế khả năng áp dụng của chúng đối với các phiên bản
cụ thể của từng gói có tên. Hạn chế của từng gói riêng lẻ được liệt kê trong
dấu ngoặc đơn sau tên của nó và phải có một mối quan hệ từ danh sách dưới
đây và theo sau là một giá trị số phiên bản.  Các mối quan hệ được cho phép
là: <code class="literal">&lt;&lt;</code>, <code class="literal">&lt;=</code>,
<code class="literal">=</code>, <code class="literal">&gt;=</code>, và
<code class="literal">&gt;&gt;</code> tương ứng với bé hơn, bé hơn hoặc bằng, chính
xác bằng, lớn hơn hoặc bằng, và lớn hơn. Ví dụ,
</p>
        <pre class="screen">
Depends: foo (&gt;= 1.2), libbar1 (= 1.3.4)
Conflicts: baz
Recommends: libbaz4 (&gt;&gt; 4.0.7)
Suggests: quux
Replaces: quux (&lt;&lt; 5), quux-foo (&lt;= 7.6)
</pre>
        <p>
Tính năng cuối cùng bạn cần biết là về <code class="literal">${shlibs:Depends}</code>,
<code class="literal">${perl:Depends}</code>, <code class="literal">${misc:Depends}</code>, vân
vân.
</p>
        <p>
<span class="citerefentry"><span class="refentrytitle">dh_shlibdeps</span>(1)</span> tính toán sự phụ thuộc vào các thư
viện chia sẻ cho các gói nhị phân. Nó sinh ra một danh sách củả tệp thực thi
<a class="ulink" href="http://wikipedia.org/wiki/Executable_and_Linkable_Format">ELF</a> và thư viện chia sẻ mà nó đã tìm cho mỗi gói
nhị phân. Danh sách này được sử dụng để thay thế
<code class="literal">${shlibs:Depends}</code>.
</p>
        <p>
<span class="citerefentry"><span class="refentrytitle">dh_perl</span>(1)</span> tính toán sự phụ thuộc Perl. Nó
sinh ra một danh sách của các phụ thuộc trong <code class="literal">perl</code> hoặc
<code class="literal">perlapi</code> cho mỗi gói nhị phân.  Danh sách này được sử dụng
thay thế cho <code class="literal">${perl:Depends}</code>.
</p>
        <p>
Một vài lệnh <code class="systemitem">debhelper</code> có thể làm
cho gói được sinh ra phụ thuộc vào vài gói mở rộng thêm. Tất cả các lệnh như
vậy sinh ra một danh sách của các gói cho mỗi gói nhị phân. Danh sách này
được sử dụng để thay thế cho <code class="literal">${misc:Depends}</code>.
</p>
        <p>
<span class="citerefentry"><span class="refentrytitle">dh_gencontrol</span>(1)</span> tạo ra
<code class="filename">DEBIAN/control</code> cho mỗi gói nhị phân trong khi thay thế
<code class="literal">${shlibs:Depends}</code>, <code class="literal">${perl:Depends}</code>,
<code class="literal">${misc:Depends}</code>, vân vân.
</p>
        <p>
Có tất cả những điều đó, chúng ta có thể để trường
<code class="literal">Depends</code> chính xác như bây giờ và chèn một dòng sau là
<code class="literal">Suggests: file</code>, bởi vì <code class="systemitem">gentoo</code> có thể sử dụng một số tính năng được cung
cấp bởi gói <code class="systemitem">file</code> .
</p>
        <p> Dòng 9 là URL Trang chủ.  Giả sử rằng đây là <a class="ulink" href="http://www.obsession.se/gentoo/">http://www.obsession.se/gentoo/</a>.
</p>
        <p>
Dòng 12 là mô tả ngắn. Thiết bị đầu cuối thông thường có 80 cột nên không
được dài hơn 60 ký tự. Tôi sẽ thay đổi nó thành  <code class="literal">fully
GUI-configurable, two-pane X file manager</code>
</p>
        <p>
Dòng 13 là nơi diễn tả dài.  Đây sẽ là một đoạn cho biết thêm chi tiết về
gói. Cột 1 của mỗi dòng nên để trống.  Không có dòng trắng, nhưng bạn có thể
đặt một <code class="literal">. </code> (dấu chấm) trong một cột để mô phỏng.  Ngoài
ra, không có nhiều dòng trống sau mô tả dài.  <a href="#ftn.idm1427" class="footnote" id="idm1427"><sup class="footnote">[34]</sup></a>
</p>
        <p>
Chúng ta có thể chèn các trường <code class="literal">Vcs-*</code> để ghi lại thông
tin của VCS trong các dòng 6 và 7. <a href="#ftn.idm1432" class="footnote" id="idm1432"><sup class="footnote">[35]</sup></a> Hãy
giả sử rằng gói <code class="systemitem">gentoo</code> có VCS của nó
nằm trong Debian Alioth Git Service ở
<code class="literal">git://git.debian.org/git/collab-maint/gentoo.git</code>.
</p>
        <p>
Cuối cùng, đây là tệp <code class="filename">control</code> đã được cập nhật
</p>
        <pre class="screen">
 1 Source: gentoo
 2 Section: x11
 3 Priority: optional
 4 Maintainer: Josip Rodin &lt;joy-mg@debian.org&gt;
 5 Build-Depends: debhelper (&gt;=9), xlibs-dev, libgtk1.2-dev, libglib1.2-dev
 6 Standards-Version: 3.9.4
 7 Vcs-Git: git://git.debian.org/git/collab-maint/gentoo.git
 8 Vcs-browser: http://git.debian.org/?p=collab-maint/gentoo.git
 9 Homepage: http://www.obsession.se/gentoo/
10
11 Package: gentoo
12 Architecture: any
13 Depends: ${shlibs:Depends}, ${misc:Depends}
14 Suggests: file
15 Description: fully GUI-configurable, two-pane X file manager
16  gentoo is a two-pane file manager for the X Window System. gentoo lets the
17  user do (almost) all of the configuration and customizing from within the
18  program itself. If you still prefer to hand-edit configuration files,
19  they're fairly easy to work with since they are written in an XML format.
20  .
21  gentoo features a fairly complex and powerful file identification system,
22  coupled to an object-oriented style system, which together give you a lot
23  of control over how files of different types are displayed and acted upon.
24  Additionally, over a hundred pixmap images are available for use in file
25  type descriptions.
26  .
29  gentoo was written from scratch in ANSI C, and it utilizes the GTK+ toolkit
30  for its interface.
</pre>
        <p>
(Tôi đã thêm các số dòng.)
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="copyright"/>4.2. <code class="filename">copyright</code></h2>
            </div>
          </div>
        </div>
        <p>
This file contains information about the copyright and license of the
upstream sources.  <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-docs.html#s-copyrightfile">Debian Policy Manual,
12.5 "Copyright information"</a> dictates its content and <a class="ulink" href="http://dep.debian.net/deps/dep5/">DEP-5: Machine-parseable
<code class="filename">debian/copyright</code></a> provides guidelines for its
format.
</p>
        <p>
<span class="command"><strong>dh_make</strong></span> can give you a template
<code class="filename">copyright</code> file.  Let's use the <code class="literal">--copyright
gpl2</code> option here to get a template file for the <code class="systemitem">gentoo</code> package released under GPL-2.
</p>
        <p>
You must fill in missing information to complete this file, such as the
place you got the package from, the actual copyright notice, and the
license.  For certain common free software licenses (GNU GPL-1, GNU GPL-2,
GNU GPL-3, LGPL-2, LGPL-2.1, LGPL-3, GNU FDL-1.2, GNU FDL-1.3, Apache-2.0,
or the Artistic license), you can just refer to the appropriate file in the
<code class="filename">/usr/share/common-licenses/</code> directory that exists on
every Debian system.  Otherwise, you must include the complete license.
</p>
        <p>
In short, here's what <code class="systemitem">gentoo</code>'s
<code class="filename">copyright</code> file should look like:
</p>
        <pre class="screen">
 1 Format-Specification: http://svn.debian.org/wsvn/dep/web/deps/dep5.mdwn?op=file&amp;rev=135
 2 Name: gentoo
 3 Maintainer: Josip Rodin &lt;joy-mg@debian.org&gt;
 4 Source: http://sourceforge.net/projects/gentoo/files/
 5
 6 Copyright: 1998-2010 Emil Brink &lt;emil@obsession.se&gt;
 7 License: GPL-2+
 8
 9 Files: icons/*
10 Copyright: 1998 Johan Hanson &lt;johan@tiq.com&gt;
11 License: GPL-2+
12
13 Files: debian/*
14 Copyright: 1998-2010 Josip Rodin &lt;joy-mg@debian.org&gt;
15 License: GPL-2+
16
17 License: GPL-2+
18  This program is free software; you can redistribute it and/or modify
19  it under the terms of the GNU General Public License as published by
20  the Free Software Foundation; either version 2 of the License, or
21  (at your option) any later version. 
22  .
23  This program is distributed in the hope that it will be useful,
24  but WITHOUT ANY WARRANTY; without even the implied warranty of
25  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
26  GNU General Public License for more details.
27  .
28  You should have received a copy of the GNU General Public License along
29  with this program; if not, write to the Free Software Foundation, Inc.,
30  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
31  .
32  On Debian systems, the full text of the GNU General Public
33  License version 2 can be found in the file
34  `/usr/share/common-licenses/GPL-2'.
</pre>
        <p>
(Tôi đã thêm các số dòng.)
</p>
        <p>
Please follow the HOWTO provided by the ftpmasters and sent to
debian-devel-announce: <a class="ulink" href="http://lists.debian.org/debian-devel-announce/2006/03/msg00023.html">http://lists.debian.org/debian-devel-announce/2006/03/msg00023.html</a>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="changelog"/>4.3. <code class="filename">changelog</code></h2>
            </div>
          </div>
        </div>
        <p>
This is a required file, which has a special format described in <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-source.html#s-dpkgchangelog">Debian Policy Manual, 4.4
"debian/changelog"</a>.  This format is used by <span class="command"><strong>dpkg</strong></span>
and other programs to obtain the version number, revision, distribution, and
urgency of your package.
</p>
        <p>
For you, it is also important, since it is good to have documented all
changes you have done.  It will help people downloading your package to see
whether there are issues with the package that they should know about.  It
will be saved as
<code class="filename">/usr/share/doc/gentoo/changelog.Debian.gz</code> in the binary
package.
</p>
        <p>
<span class="command"><strong>dh_make</strong></span> created a default one, and this is what it looks
like:
</p>
        <pre class="screen">
1  gentoo (0.9.12-1) unstable; urgency=low
2
3   * Initial release (Closes: #<em class="replaceable"><code>nnnn</code></em>)  &lt;<em class="replaceable"><code>nnnn</code></em> is the bug number of your ITP&gt;
4
5  -- Josip Rodin &lt;joy-mg@debian.org&gt;  Mon, 22 Mar 2010 00:37:31 +0100
6
</pre>
        <p>
(Tôi đã thêm các số dòng.)
</p>
        <p>
Line 1 is the package name, version, distribution, and urgency.  The name
must match the source package name; distribution should be
<code class="literal">unstable</code>, and urgency shouldn't be changed to anything
higher than <code class="literal">low</code>.  :-)
</p>
        <p>
Lines 3-5 are a log entry, where you document changes made in this package
revision (not the upstream changes - there is a special file for that
purpose, created by the upstream authors, which you will later install as
<code class="filename">/usr/share/doc/gentoo/changelog.gz</code>).  Let's assume your
ITP (Intent To Package) bug report number was <code class="literal">12345</code>.  New
lines must be inserted just below the uppermost line that begins with
<code class="literal">*</code> (asterisk).  You can do it with <span class="citerefentry"><span class="refentrytitle">dch</span>(1)</span>,
or manually with a text editor.
</p>
        <p>
In order to prevent a package being accidentally uploaded before completing
the package, it is good idea to change the distribution value to an invalid
distribution value <code class="literal">UNRELEASED</code>.
</p>
        <p>
You will end up with something like this:
</p>
        <pre class="screen">
1  gentoo (0.9.12-1) UNRELEASED; urgency=low
2
3   * Initial Release. Closes: #12345
4   * This is my first Debian package.
5   * Adjusted the Makefile to fix $(DESTDIR) problems.
6
7  -- Josip Rodin &lt;joy-mg@debian.org&gt;  Mon, 22 Mar 2010 00:37:31 +0100
8
</pre>
        <p>
(Tôi đã thêm các số dòng.)
</p>
        <p>
Once you are satisfied with all the changes and documented them in
<code class="filename">changelog</code>, you should change the distribution value
from <code class="literal">UNRELEASED</code> to the target distribution value
<code class="literal">unstable</code> (or even <code class="literal">experimental</code>).
<a href="#ftn.idm1496" class="footnote" id="idm1496"><sup class="footnote">[36]</sup></a>
</p>
        <p>
You can read more about updating the <code class="filename">changelog</code> file
later in <a class="xref" href="update.vi.html" title="Chương 8. Cập nhật gói phần mềm">Chương 8, <em>Cập nhật gói phần mềm</em></a>.
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a id="rules"/>4.4. <code class="filename">rules</code></h2>
            </div>
          </div>
        </div>
        <p>
Now we need to take a look at the exact rules which <span class="citerefentry"><span class="refentrytitle">dpkg-buildpackage</span>(1)</span> will use to actually create the package.  This file is in
fact another <code class="filename">Makefile</code>, but different from the one(s) in
the upstream source.  Unlike other files in <code class="filename">debian</code>,
this one is marked as executable.
</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="targets"/>4.4.1. Targets of the <code class="filename">rules</code> file</h3>
              </div>
            </div>
          </div>
          <p>
Every <code class="filename">rules</code> file, like any other
<code class="filename">Makefile</code>, consists of several rules, each of which
defines a target and how it is carried out.  <a href="#ftn.idm1518" class="footnote" id="idm1518"><sup class="footnote">[37]</sup></a> A new rule begins with its target declaration in the first column.
The following lines beginning with the TAB code (ASCII 9) specify the recipe
for carrying out that target.  Empty lines and lines beginning with
<code class="literal">#</code> (hash) are treated as comments and ignored.
<a href="#ftn.idm1526" class="footnote" id="idm1526"><sup class="footnote">[38]</sup></a>
</p>
          <p>
A rule that you want to execute is invoked by its target name as a command
line argument.  For example, <code class="literal">debian/rules
<em class="replaceable"><code>build</code></em></code> and <code class="literal">fakeroot make -f
debian/rules <em class="replaceable"><code>binary</code></em></code> execute rules for
<code class="literal"><em class="replaceable"><code>build</code></em></code> and
<code class="literal"><em class="replaceable"><code>binary</code></em></code> targets respectively.
</p>
          <p>
Here is a simplified explanation of the targets:
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
<code class="literal">clean</code> target: to clean all compiled, generated, and
useless files in the build-tree.  (Required)
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">build</code> target: to build the source into compiled programs
and formatted documents in the build-tree.  (Required)
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">build-arch</code> target: to build the source into
arch-dependent compiled programs in the build-tree.  (Required)
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">build-indep</code> target: to build the source into
arch-independent formatted documents in the build-tree.  (Required)
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">install</code> target: to install files into a file tree for
each binary package under the <code class="filename">debian</code> directory.  If
defined, <code class="literal">binary*</code> targets effectively depend on this
target.  (Optional)
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">binary</code> target: to create all binary packages (effectively
a combination of <code class="literal">binary-arch</code> and
<code class="literal">binary-indep</code> targets).  (Required)<a href="#ftn.idm1562" class="footnote" id="idm1562"><sup class="footnote">[39]</sup></a>
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">binary-arch</code> target: to create arch-dependent
(<code class="literal">Architecture: any</code>) binary packages in the parent
directory.  (Required)<a href="#ftn.idm1570" class="footnote" id="idm1570"><sup class="footnote">[40]</sup></a>
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">binary-indep</code> target: to create arch-independent
(<code class="literal">Architecture: all</code>) binary packages in the parent
directory.  (Required)<a href="#ftn.idm1578" class="footnote" id="idm1578"><sup class="footnote">[41]</sup></a>
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">get-orig-source</code> target: to obtain the most recent version
of the original source package from an upstream archive.  (Optional)
</p>
              </li>
            </ul>
          </div>
          <p>
You are probably overwhelmed by now, but things are much simpler upon
examination of the <code class="filename">rules</code> file that
<span class="command"><strong>dh_make</strong></span> gives us as a default.
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="defaultrules"/>4.4.2. Default <code class="filename">rules</code> file</h3>
              </div>
            </div>
          </div>
          <p>
Newer <span class="command"><strong>dh_make</strong></span> generates a very simple but powerful
default <code class="filename">rules</code> file using the <span class="command"><strong>dh</strong></span>
command:
</p>
          <pre class="screen">
 1 #!/usr/bin/make -f
 2 # See debhelper(7) (uncomment to enable)
 3 # output every command that modifies files on the build system.
 4 #DH_VERBOSE = 1
 5 
 6 # see EXAMPLES in dpkg-buildflags(1) and read /usr/share/dpkg/*
 7 DPKG_EXPORT_BUILDFLAGS = 1
 8 include /usr/share/dpkg/default.mk
 9 
10 # see FEATURE AREAS in dpkg-buildflags(1)
11 #export DEB_BUILD_MAINT_OPTIONS = hardening=+all
12
13 # see ENVIRONMENT in dpkg-buildflags(1)
14 # package maintainers to append CFLAGS
15 #export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
16 # package maintainers to append LDFLAGS
17 #export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed
18 
19 # main packaging script based on dh7 syntax
20 %:
21         dh $@ 
</pre>
          <p>
(I've added the line numbers and trimmed some comments.  In the actual
<code class="filename">rules</code> file, the leading spaces are a TAB code.)
</p>
          <p>
You are probably familiar with lines like line 1 from shell and Perl
scripts.  It tells the operating system that this file is to be processed
with <code class="filename">/usr/bin/make</code>.
</p>
          <p>
Line 4 can be uncommented to set the <code class="literal">DH_VERBOSE</code> variable
to 1, so that the <span class="command"><strong>dh</strong></span> command outputs which
<span class="command"><strong>dh_*</strong></span> commands it is executing.  You can also add a line
<code class="literal">export DH_OPTIONS=-v</code> here, so that each
<span class="command"><strong>dh_*</strong></span> command outputs which commands it is executing.
This helps you to understand exactly what is going on behind this simple
<code class="filename">rules</code> file and to debug its problems.  This new
<span class="command"><strong>dh</strong></span> is designed to form a core part of the <code class="systemitem">debhelper</code> tools, and not to hide anything from
you.
</p>
          <p>
Lines 20 and 21 are where all the work is done with an implicit rule using
the pattern rule.  The percent sign means "any targets", which then call a
single program, <span class="command"><strong>dh</strong></span>, with the target name.  <a href="#ftn.idm1610" class="footnote" id="idm1610"><sup class="footnote">[42]</sup></a> The <span class="command"><strong>dh</strong></span> command is a wrapper
script which runs appropriate sequences of <span class="command"><strong>dh_*</strong></span> programs
depending on its argument.  <a href="#ftn.idm1626" class="footnote" id="idm1626"><sup class="footnote">[43]</sup></a>
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
<code class="literal">debian/rules clean</code> runs <code class="literal">dh clean</code>,
which in turn runs the following:
</p>
                <pre class="screen">
dh_testdir
dh_auto_clean
dh_clean
</pre>
              </li>
              <li class="listitem">
                <p>
<code class="literal">debian/rules build</code> runs <code class="literal">dh build</code>;
which in turn runs the following:
</p>
                <pre class="screen">
dh_testdir
dh_auto_configure
dh_auto_build
dh_auto_test
</pre>
              </li>
              <li class="listitem">
                <p>
<code class="literal">fakeroot debian/rules binary</code> runs <code class="literal">fakeroot dh
binary</code>; which in turn runs the following<a href="#ftn.idm1650" class="footnote" id="idm1650"><sup class="footnote">[44]</sup></a>:
</p>
                <pre class="screen">
dh_testroot
dh_prep
dh_installdirs
dh_auto_install
dh_install
dh_installdocs
dh_installchangelogs
dh_installexamples
dh_installman
dh_installcatalogs
dh_installcron
dh_installdebconf
dh_installemacsen
dh_installifupdown
dh_installinfo
dh_installinit
dh_installmenu
dh_installmime
dh_installmodules
dh_installlogcheck
dh_installlogrotate
dh_installpam
dh_installppp
dh_installudev
dh_installwm
dh_installxfonts
dh_bugfiles
dh_lintian
dh_gconf
dh_icons
dh_perl
dh_usrlocal
dh_link
dh_compress
dh_fixperms
dh_strip
dh_makeshlibs
dh_shlibdeps
dh_installdeb
dh_gencontrol
dh_md5sums
dh_builddeb
</pre>
              </li>
              <li class="listitem">
                <p>
<code class="literal">fakeroot debian/rules binary-arch</code> runs <code class="literal">fakeroot
dh binary-arch</code>; which in turn runs the same sequence as
<code class="literal">fakeroot dh binary</code> but with the <code class="literal">-a</code>
option appended for each command.
</p>
              </li>
              <li class="listitem">
                <p>
<code class="literal">fakeroot debian/rules binary-indep</code> runs <code class="literal">fakeroot
dh binary-indep</code>; which in turn runs almost the same sequence as
<code class="literal">fakeroot dh binary</code> but excluding
<span class="command"><strong>dh_strip</strong></span>, <span class="command"><strong>dh_makeshlibs</strong></span>, and
<span class="command"><strong>dh_shlibdeps</strong></span> with the <code class="literal">-i</code> option
appended for each remaining command.
</p>
              </li>
            </ul>
          </div>
          <p>
The functions of <span class="command"><strong>dh_*</strong></span> commands are largely self-evident
from their names.  <a href="#ftn.idm1671" class="footnote" id="idm1671"><sup class="footnote">[45]</sup></a> There are a few
notable ones that are worth giving (over)simplified explanations here
assuming a typical build environment based on a
<code class="filename">Makefile</code>: <a href="#ftn.idm1676" class="footnote" id="idm1676"><sup class="footnote">[46]</sup></a>
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
<span class="command"><strong>dh_auto_clean</strong></span> usually executes the following if a
<code class="filename">Makefile</code> exists with the <code class="literal">distclean</code>
target.  <a href="#ftn.idm1686" class="footnote" id="idm1686"><sup class="footnote">[47]</sup></a>
</p>
                <pre class="screen">
make distclean
</pre>
              </li>
              <li class="listitem">
                <p>
<span class="command"><strong>dh_auto_configure</strong></span> usually executes the following if
<code class="filename">./configure</code> exists (arguments abbreviated for
readability).
</p>
                <pre class="screen">
./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var ...
</pre>
              </li>
              <li class="listitem">
                <p>
<span class="command"><strong>dh_auto_build</strong></span> usually executes the following to execute
the first target of <code class="filename">Makefile</code> if it exists.
</p>
                <pre class="screen">
make
</pre>
              </li>
              <li class="listitem">
                <p>
<span class="command"><strong>dh_auto_test</strong></span> usually executes the following if a
<code class="filename">Makefile</code> exists with the <code class="literal">test</code>
target.  <a href="#ftn.idm1708" class="footnote" id="idm1708"><sup class="footnote">[48]</sup></a>
</p>
                <pre class="screen">
make test
</pre>
              </li>
              <li class="listitem">
                <p>
<span class="command"><strong>dh_auto_install</strong></span> usually executes the following if a
<code class="filename">Makefile</code> exists with the <code class="literal">install</code>
target (line folded for readability).
</p>
                <pre class="screen">
make install \
  DESTDIR=<em class="replaceable"><code>/path/to</code></em>/<em class="replaceable"><code>package</code></em>_<em class="replaceable"><code>version</code></em>-<em class="replaceable"><code>revision</code></em>/debian/<em class="replaceable"><code>package</code></em>
</pre>
              </li>
            </ul>
          </div>
          <p>
All targets which require the <span class="command"><strong>fakeroot</strong></span> command will
contain <span class="command"><strong>dh_testroot</strong></span>, which exits with an error if you are
not using this command to pretend to be root.
</p>
          <p>
The important part to know about the <code class="filename">rules</code> file created
by <span class="command"><strong>dh_make</strong></span> is that it is just a suggestion.  It will work
for most packages but for more complicated ones, don't be afraid to
customize it to fit your needs.
</p>
          <p>
Although <code class="literal">install</code> is not a required target, it is
supported.  <code class="literal">fakeroot dh install</code> behaves like
<code class="literal">fakeroot dh binary</code> but stops after
<span class="command"><strong>dh_fixperms</strong></span>.
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a id="customrules"/>4.4.3. Customization of <code class="filename">rules</code> file</h3>
              </div>
            </div>
          </div>
          <p>
There are many ways to customize the <code class="filename">rules</code> file created
with the new <span class="command"><strong>dh</strong></span> command.
</p>
          <p>
The <code class="literal">dh $@</code> command can be customized as follows:
<a href="#ftn.idm1744" class="footnote" id="idm1744"><sup class="footnote">[49]</sup></a>
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist">
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_python2</strong></span> command.  (The best choice
for Python.) <a href="#ftn.idm1754" class="footnote" id="idm1754"><sup class="footnote">[50]</sup></a>
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">python</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with python2</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This handles Python modules using the <code class="systemitem">python</code> framework.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_pysupport</strong></span> command. (deprecated)
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">python-support</code> package
in <code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with pysupport</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This handles Python modules using the <code class="systemitem">python-support</code> framework.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_pycentral</strong></span> command. (deprecated)
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">python-central</code> package
in <code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with python-central</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This also deactivates the <span class="command"><strong>dh_pysupport</strong></span> command.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This handles Python modules using the <code class="systemitem">python-central</code> framework.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_installtex</strong></span> command.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">tex-common</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with tex</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This registers Type 1 fonts, hyphenation patterns, and formats with TeX.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_quilt_patch</strong></span> and
<span class="command"><strong>dh_quilt_unpatch</strong></span> commands.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">quilt</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with quilt</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This applies and un-applies patches to the upstream source from files in the
<code class="filename">debian/patches</code> directory for a source package in the
<code class="literal">1.0</code> format.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This is not needed if you use the new <code class="literal">3.0 (quilt)</code> source
package format.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_dkms</strong></span> command.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">dkms</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with dkms</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This correctly handles DKMS usage by kernel module packages.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_autotools-dev_updateconfig</strong></span> and
<span class="command"><strong>dh_autotools-dev_restoreconfig</strong></span> commands.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">autotools-dev</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with autotools-dev</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This updates and restores <code class="filename">config.sub</code> and
<code class="filename">config.guess</code>.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_autoreconf</strong></span> and
<span class="command"><strong>dh_autoreconf_clean</strong></span> commands.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Include the <code class="systemitem">dh-autoreconf</code> package in
<code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with autoreconf</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This updates the GNU Build System files and restores them after the build.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>dh_girepository</strong></span> command.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Includes the <code class="systemitem">gobject-introspection</code>
package in <code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with gir</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This computes dependencies for packages shipping GObject introspection data
and generates the <code class="literal">${gir:Depends}</code> substitution variable
for the package dependency.
</p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
Add support for the <span class="command"><strong>bash</strong></span> completion feature.
</p>
                <div class="itemizedlist">
                  <ul class="itemizedlist">
                    <li class="listitem">
                      <p>
Includes the <code class="systemitem">bash-completion</code> package
in <code class="literal">Build-Depends</code>.
</p>
                    </li>
                    <li class="listitem">
                      <p>
Use <code class="literal">dh $@ --with bash-completion</code> instead.
</p>
                    </li>
                    <li class="listitem">
                      <p>
This installs <span class="command"><strong>bash</strong></span> completions using a configuration file
at
<code class="filename">debian/<em class="replaceable"><code>package</code></em>.bash-completion</code>.
</p>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
          <p>
Many <span class="command"><strong>dh_*</strong></span> commands invoked by the new
<span class="command"><strong>dh</strong></span> command can be customized by the corresponding
configuration files in the <code class="filename">debian</code> directory.  See <a class="xref" href="dother.vi.html" title="Chương 5. Other files under the debian directory">Chương 5, <em>Other files under the <code class="filename">debian</code> directory</em></a> and the manpage of each command for the customization of
such features.
</p>
          <p>
You may need to run <span class="command"><strong>dh_*</strong></span> commands invoked via the new
<span class="command"><strong>dh</strong></span> with added arguments, or to run additional commands
with them, or to skip them.  For such cases, you create an
<code class="literal">override_dh_<em class="replaceable"><code>foo</code></em></code> target with
its rule in the <code class="filename">rules</code> file defining an
<code class="literal">override_dh_<em class="replaceable"><code>foo</code></em></code> target for the
<span class="command"><strong>dh_<em class="replaceable"><code>foo</code></em></strong></span> command you want to
change.  It basically says <span class="emphasis"><em>run me instead</em></span>.
<a href="#ftn.idm1923" class="footnote" id="idm1923"><sup class="footnote">[51]</sup></a>
</p>
          <p>
Please note that the <span class="command"><strong>dh_auto_*</strong></span> commands tend to do more
than what has been discussed in this (over)simplified explanation to take
care of all the corner cases.  It is a bad idea to use
<code class="literal">override_dh_*</code> targets to substitute simplified equivalent
commands (except for the <code class="literal">override_dh_auto_clean</code> target)
since it may bypass such smart <code class="systemitem">debhelper</code> features.
</p>
          <p>
So, for instance, if you want to store system configuration data in the
<code class="filename">/etc/gentoo</code> directory instead of the usual
<code class="filename">/etc</code> directory for the recent <code class="systemitem">gentoo</code> package using Autotools, you can override
the default <code class="literal">--sysconfig=/etc</code> argument given by the
<span class="command"><strong>dh_auto_configure</strong></span> command to the
<span class="command"><strong>./configure</strong></span> command by the following:
</p>
          <pre class="screen">
override_dh_auto_configure:
        dh_auto_configure -- --sysconfig=/etc/gentoo
</pre>
          <p>
The arguments given after <code class="literal">--</code> are appended to the default
arguments of the auto-executed program to override them.  Using the
<span class="command"><strong>dh_auto_configure</strong></span> command is better than directly
invoking the <span class="command"><strong>./configure</strong></span> command here since it will only
override the <code class="literal">--sysconfig</code> argument and retains any other,
benign arguments to the <span class="command"><strong>./configure</strong></span> command.
</p>
          <p>
If the <code class="filename">Makefile</code> in the source for <code class="systemitem">gentoo</code> requires you to specify
<code class="literal">build</code> as its target to build it <a href="#ftn.idm1951" class="footnote" id="idm1951"><sup class="footnote">[52]</sup></a>, you create an
<code class="literal">override_dh_auto_build</code> target to enable this.
</p>
          <pre class="screen">
override_dh_auto_build:
        dh_auto_build -- build
</pre>
          <p>
This ensures <code class="literal">$(MAKE)</code> is run with all the default
arguments given by the <span class="command"><strong>dh_auto_build</strong></span> command plus the
<code class="literal">build</code> argument.
</p>
          <p>
If the <code class="filename">Makefile</code> in the source for <code class="systemitem">gentoo</code> requires you to specify the
<code class="literal">packageclean</code> target to clean it for the Debian package
instead of using <code class="literal">distclean</code> or <code class="literal">clean</code>
targets, you can create an <code class="literal">override_dh_auto_clean</code> target
to enable it.
</p>
          <pre class="screen">
override_dh_auto_clean:
        $(MAKE) packageclean
</pre>
          <p>
If the <code class="filename">Makefile</code> in the source for <code class="systemitem">gentoo</code> contains a <code class="literal">test</code> target
which you do not want to run for the Debian package building process, you
can use an empty <code class="literal">override_dh_auto_test</code> target to skip it.
</p>
          <pre class="screen">
override_dh_auto_test:
</pre>
          <p>
If <code class="systemitem">gentoo</code> has an unusual upstream
changelog file called <code class="filename">FIXES</code>,
<span class="command"><strong>dh_installchangelogs</strong></span> will not install that file by
default.  The <span class="command"><strong>dh_installchangelogs</strong></span> command requires
<code class="filename">FIXES</code> as its argument to install it.  <a href="#ftn.idm1981" class="footnote" id="idm1981"><sup class="footnote">[53]</sup></a>
</p>
          <pre class="screen">
override_dh_installchangelogs:
        dh_installchangelogs FIXES
</pre>
          <p>
When you use the new <span class="command"><strong>dh</strong></span> command, use of explicit targets
such as the ones listed in <a class="xref" href="dreq.vi.html#targets" title="4.4.1. Targets of the rules file">Phần 4.4.1, “Targets of the <code class="filename">rules</code> file”</a>, other than the
<code class="literal">get-orig-source</code> target, may make it difficult to
understand their exact effects.  Please limit explicit targets to
<code class="literal">override_dh_*</code> targets and completely independent ones, if
possible.
</p>
        </div>
      </div>
      <div class="footnotes">
        <br/>
        <hr/>
        <div id="ftn.idm1156" class="footnote">
          <p><a href="#idm1156" class="para"><sup class="para">[27] </sup></a>
Trong chương này, các tệp tin trong thư mục <code class="filename">debian</code> được
đề cập đến mà không có <code class="filename">debian/</code> để đơn giản hóa bất cứ
khi nhắc tới.
</p>
        </div>
        <div id="ftn.idm1189" class="footnote">
          <p><a href="#idm1189" class="para"><sup class="para">[28] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-archive.html#s-subsections">Debian Policy Manual, 2.4
"Sections"</a> và <a class="ulink" href="http://packages.debian.org/unstable/">List of sections in
<code class="literal">sid</code></a>.</p>
        </div>
        <div id="ftn.idm1197" class="footnote">
          <p><a href="#idm1197" class="para"><sup class="para">[29] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-archive.html#s-priorities">Debian Policy Manual, 2.5
"Priorities"</a>.
</p>
        </div>
        <div id="ftn.idm1220" class="footnote">
          <p><a href="#idm1220" class="para"><sup class="para">[30] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-relationships.html#s-sourcebinarydeps">Debian Policy
Manual, 7.7 "Relationships between source and binary packages -
Build-Depends, Build-Depends-Indep, Build-Conflicts,
Build-Conflicts-Indep"</a>.</p>
        </div>
        <div id="ftn.idm1250" class="footnote">
          <p><a href="#idm1250" class="para"><sup class="para">[31] </sup></a> Tình huống này hơi lạ là một tính năng được ghi lại trong  <a class="ulink" href="http://www.debian.org/doc/debian-policy/footnotes.html#f55">Debian Policy Manual, Footnotes
55</a>. Đây không phải là do sử dụng lệnh <span class="command"><strong>dh</strong></span> trong
tệp tin <code class="filename">debian/rules</code> nhưng do cách
<span class="command"><strong>dpkg-buildpackage</strong></span> làm việc. Tình huống tương tự cũng áp
dụng cho <a class="ulink" href="https://bugs.launchpad.net/launchpad-buildd/+bug/238141">hệ thống xây
dựng tự động cho Ubuntu</a>.  </p>
        </div>
        <div id="ftn.idm1282" class="footnote">
          <p><a href="#idm1282" class="para"><sup class="para">[32] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-Architecture">Debian Policy Manual, 5.6.8
"Architecture"</a> để biết chi tiết.
</p>
        </div>
        <div id="ftn.idm1330" class="footnote">
          <p><a href="#idm1330" class="para"><sup class="para">[33] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-relationships.html">Debian Policy Manual, 7 "Declaring
relationships between packages"</a>.
</p>
        </div>
        <div id="ftn.idm1427" class="footnote">
          <p><a href="#idm1427" class="para"><sup class="para">[34] </sup></a>Những mô tả này bằng tiếng Anh. Các bản dịch về các mô tả này được cung cấp
bởi <a class="ulink" href="http://www.debian.org/intl/l10n/ddtp">The Debian Description Translation Project -
DDTP</a>.</p>
        </div>
        <div id="ftn.idm1432" class="footnote">
          <p><a href="#idm1432" class="para"><sup class="para">[35] </sup></a>Xem <a class="ulink" href="http://www.debian.org/doc/manuals/developers-reference/best-pkging-practices.html#bpp-vcs">Debian Developer's Reference,
6.2.5. "Version Control System location"</a>.
</p>
        </div>
        <div id="ftn.idm1496" class="footnote">
          <p><a href="#idm1496" class="para"><sup class="para">[36] </sup></a>If you use the <code class="literal">dch -r</code> command to make this last change,
please make sure to save the <code class="filename">changelog</code> file explicitly
by the editor.</p>
        </div>
        <div id="ftn.idm1518" class="footnote">
          <p><a href="#idm1518" class="para"><sup class="para">[37] </sup></a>You can start learning how to write <code class="filename">Makefile</code> from
<a class="ulink" href="http://www.debian.org/doc/manuals/debian-reference/ch12#_make">Debian Reference, 12.2. "Make"</a>.  The full
documentation is available as <a class="ulink" href="http://www.gnu.org/software/make/manual/html_node/index.html">http://www.gnu.org/software/make/manual/html_node/index.html</a> or as the
<code class="systemitem">make-doc</code> package in the
<code class="literal">non-free</code> archive area.
</p>
        </div>
        <div id="ftn.idm1526" class="footnote">
          <p><a href="#idm1526" class="para"><sup class="para">[38] </sup></a><a class="ulink" href="http://www.debian.org/doc/debian-policy/ch-source.html#s-debianrules">Debian Policy Manual, 4.9 "Main building
script: debian/rules"</a> explains the details.</p>
        </div>
        <div id="ftn.idm1562" class="footnote">
          <p><a href="#idm1562" class="para"><sup class="para">[39] </sup></a> This target is used by <code class="literal">dpkg-buildpackage</code> as in <a class="xref" href="build.vi.html#completebuild" title="6.1. (Tái) biên dịch toàn bộ">Phần 6.1, “(Tái) biên dịch toàn bộ”</a>.  </p>
        </div>
        <div id="ftn.idm1570" class="footnote">
          <p><a href="#idm1570" class="para"><sup class="para">[40] </sup></a> This target is used by <code class="literal">dpkg-buildpackage -B</code> as in <a class="xref" href="build.vi.html#autobuilder" title="6.2. Tự động biên dịch">Phần 6.2, “Tự động biên dịch”</a>.  </p>
        </div>
        <div id="ftn.idm1578" class="footnote">
          <p><a href="#idm1578" class="para"><sup class="para">[41] </sup></a> This target is used by <code class="literal">dpkg-buildpackage -A</code>.  </p>
        </div>
        <div id="ftn.idm1610" class="footnote">
          <p><a href="#idm1610" class="para"><sup class="para">[42] </sup></a> This uses the new <code class="systemitem">debhelper</code> v7+
features.  Its design concepts are explained in <a class="ulink" href="http://joey.kitenet.net/talks/debhelper/debhelper-slides.pdf">Not Your Grandpa's Debhelper</a> presented at
DebConf9 by the <code class="systemitem">debhelper</code> upstream.
Under <code class="literal">lenny</code>, <span class="command"><strong>dh_make</strong></span> created a much
more complicated <code class="filename">rules</code> file with explicit rules and
many <span class="command"><strong>dh_*</strong></span> scripts listed for each one, most of which are
now unnecessary (and show the package's age). The new <span class="command"><strong>dh</strong></span>
command is simpler and frees us from doing the routine work "manually". You
still have full power to customize the process with
<code class="literal">override_dh_*</code> targets. See <a class="xref" href="dreq.vi.html#customrules" title="4.4.3. Customization of rules file">Phần 4.4.3, “Customization of <code class="filename">rules</code> file”</a>.  It is based only on the <code class="systemitem">debhelper</code> package and does not obfuscate the
package building process as the <code class="systemitem">cdbs</code>
package tends to.  </p>
        </div>
        <div id="ftn.idm1626" class="footnote">
          <p><a href="#idm1626" class="para"><sup class="para">[43] </sup></a> You can verify the actual sequences of <span class="command"><strong>dh_*</strong></span> programs
invoked for a given <code class="literal"><em class="replaceable"><code>target</code></em></code>
without really running them by invoking <code class="literal">dh --no-act
<em class="replaceable"><code>target</code></em></code> or <code class="literal">debian/rules --
'--no-act <em class="replaceable"><code>target</code></em>'</code>.  </p>
        </div>
        <div id="ftn.idm1650" class="footnote">
          <p><a href="#idm1650" class="para"><sup class="para">[44] </sup></a>The following example assumes your <code class="filename">debian/compat</code> has a
value equal or more than 9 to avoid invoking any python support commands
automatically.
</p>
        </div>
        <div id="ftn.idm1671" class="footnote">
          <p><a href="#idm1671" class="para"><sup class="para">[45] </sup></a> For complete information on what all these <span class="command"><strong>dh_*</strong></span> scripts
do exactly, and what their other options are, please read their respective
manual pages and the <code class="systemitem">debhelper</code>
documentation.  </p>
        </div>
        <div id="ftn.idm1676" class="footnote">
          <p><a href="#idm1676" class="para"><sup class="para">[46] </sup></a> These commands support other build environments such as
<code class="filename">setup.py</code> which can be listed by executing
<code class="literal">dh_auto_build --list</code> in a package source directory.  </p>
        </div>
        <div id="ftn.idm1686" class="footnote">
          <p><a href="#idm1686" class="para"><sup class="para">[47] </sup></a> It actually looks for the first available target in the
<code class="filename">Makefile</code> out of <code class="literal">distclean</code>,
<code class="literal">realclean</code>, or <code class="literal">clean</code>, and executes
that.
</p>
        </div>
        <div id="ftn.idm1708" class="footnote">
          <p><a href="#idm1708" class="para"><sup class="para">[48] </sup></a> It actually looks for the first available target in the
<code class="filename">Makefile</code> out of <code class="literal">test</code> or
<code class="literal">check</code>, and executes that.</p>
        </div>
        <div id="ftn.idm1744" class="footnote">
          <p><a href="#idm1744" class="para"><sup class="para">[49] </sup></a> If a package installs the
<code class="filename">/usr/share/perl5/Debian/Debhelper/Sequence/<em class="replaceable"><code>custom_name</code></em>.pm</code>
file, you should activate its customization function by <code class="literal">dh $@
--with <em class="replaceable"><code>custom-name</code></em></code>.  </p>
        </div>
        <div id="ftn.idm1754" class="footnote">
          <p><a href="#idm1754" class="para"><sup class="para">[50] </sup></a> Use of the <span class="command"><strong>dh_python2</strong></span> command is preferred over use of
<span class="command"><strong>dh_pysupport</strong></span> or <span class="command"><strong>dh_pycentral</strong></span>
commands.  Do not use the <span class="command"><strong>dh_python</strong></span> command.  </p>
        </div>
        <div id="ftn.idm1923" class="footnote">
          <p><a href="#idm1923" class="para"><sup class="para">[51] </sup></a> Under <code class="literal">lenny</code>, if you wanted to change the behavior of a
<span class="command"><strong>dh_*</strong></span> script you found the relevant line in the
<code class="filename">rules</code> file and adjusted it.  </p>
        </div>
        <div id="ftn.idm1951" class="footnote">
          <p><a href="#idm1951" class="para"><sup class="para">[52] </sup></a>
<span class="command"><strong>dh_auto_build</strong></span> without any arguments will execute the
first target in the <code class="filename">Makefile</code>.  </p>
        </div>
        <div id="ftn.idm1981" class="footnote">
          <p><a href="#idm1981" class="para"><sup class="para">[53] </sup></a> The <code class="filename">debian/changelog</code> and
<code class="filename">debian/NEWS</code> files are always automatically installed.
The upstream changelog is found by converting filenames to lower case and
matching them against <code class="filename">changelog</code>,
<code class="filename">changes</code>, <code class="filename">changelog.txt</code>, and
<code class="filename">changes.txt</code>.
</p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr/>
      <table width="100%" summary="Navigation footer">
        <tr>
          <td align="left"><a accesskey="p" href="modify.vi.html"><img src="images/prev.png" alt="Trước đó"/></a> </td>
          <td align="center"> </td>
          <td align="right"> <a accesskey="n" href="dother.vi.html"><img src="images/next.png" alt="Kế tiếp"/></a></td>
        </tr>
        <tr>
          <td align="left" valign="top">Chương 3. Sửa đổi mã nguồn </td>
          <td align="center">
            <a accesskey="h" href="index.vi.html">
              <img src="images/home.png" alt="Đầu"/>
            </a>
          </td>
          <td align="right" valign="top"> Chương 5. Other files under the <code class="filename">debian</code> directory</td>
        </tr>
      </table>
    </div>
  </body>
</html>
